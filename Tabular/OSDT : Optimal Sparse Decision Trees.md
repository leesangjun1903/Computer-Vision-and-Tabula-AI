# Optimal Sparse Decision Trees

**주요 주장 및 기여**  
Optimal Sparse Decision Trees(OSDT)는 이진 변수에 대해 해석 가능하고 희소한(leaf 수가 적은) 의사결정 나무를 **최적화 문제**로 정의하고, 이를 **정확도(오류율)와 나무 복잡도(leaf 수)** 사이의 **정규화된 손실 함수**로 해결하는 최초의 실용적 알고리즘을 제안한다. 주요 기여는 다음과 같다:[1]
- 이진 변수 결정트리에 대한 **최초의 실용적 최적화 알고리즘** 제시.[1]
- **검색 공간 대폭 축소**를 위한 일련의 **해석적 경계(bound)** 도입(계층적 하한, 한 단계 전망, 노드 지지율·정확도 하한 등).[1]
- **leaf 전용 표현**을 활용한 트리 구조 설계로 메모리·연산량 절감.[1]
- **전용 비트벡터 라이브러리** 및 데이터 구조 최적화 통해 실행속도 97% 절감.[1]
- COMPAS·FICO 데이터셋에 대한 **최초의 최적 희소 이진 분할 결정트리** 구축.[1]

***

## 1. 해결하려는 문제  
기존 CART·C4.5 같은 그리디 트리 알고리즘은 **전역 최적성 보장 없이** 분할을 수행하므로 상위 노드의 비최적 분할을 하위 노드로 되돌리기 어려워, 해석 가능성·정확도 면에서 떨어지는 **suboptimal tree**를 산출한다. 일반적인 수리 최적화 접근법은 **모든 형태의 트리**를 고려할 경우 계산복잡도가 기하급수적으로 커져 현실적 규모 데이터에 적용이 어려웠다.[1]

***

## 2. 제안 방법  
### 2.1 정규화된 손실 함수  
트리 $$d$$에 대해  

$$
R(d,x,y) = \ell(d,x,y) + \lambda H_d
$$  

로 정의하며, $$\ell$$은 **오분류율**, $$H_d$$는 **leaf 수**, $$\lambda$$는 **규제 파라미터**이다.[1]

### 2.2 분기-경계(Branch-and-Bound) 기반 최적화  
- **계층적 하한**: prefix인 변경 불가 leaf만 고려해  

$$
  b(d_{\text{un}},x,y) = \ell_p(d_{\text{un}},x,y) + \lambda H_d \le R(d,x,y)
  $$  
  
  모든 자손 트리에 대한 하한을 제공한다.[1]
- **한 단계 전망(One-step Lookahead)**: split 당 최소 개선분  

$$
  a_k \;=\;\frac{1}{N}\sum_n\bigl[\dots\bigr],\quad
  \lambda\le a_k
  $$  
  
  split시 오분류 감소량이 $$\lambda$$ 이상이어야 탐색 유지.[1]
- **노드 지지율 하한**: 자식 leaf 쌍 $$(p_k,p_{k+1})$$의 지지율 합이  

```math
  \text{supp}(p_k)+\text{supp}(p_{k+1})\ge2\lambda
```

- **정확도 하한**: 각 leaf의 정확도(정분류율)도 $$\lambda$$ 이상 유지 필수.[1]
- **동형(tree permutation)·동치(equivalent points) bound**: 대칭·동일 포인트로 인한 중복 탐색 제거.[1]

이를 통해 **대규모 검색 공간**을 수십억 건에서 실질적 범위로 축소하고, **provable optimality**를 달성한다.

***

## 3. 모델 구조  
OSDT는 **모든 가능한 분할(feature·threshold, leaf 조합)**을 고려하나, 상기 경계로 **대규모 pruning**을 수행한다. 트리는 **leaf 집합**으로 표현하며, 각 leaf는 **비트벡터**로 샘플 포착 여부를 표시해 incremental 연산을 지원한다. 탐색 순서는 **curiosity metric**(lower-bound÷support) 기반 우선순위 큐로 관리하여 효율성을 높인다.[1]

***

## 4. 성능 향상 및 한계  
- **성능**: COMPAS·FICO·UCI 벤치마크에서 30분 제한 내 **최적 해**를 도출. CART 대비 동일 leaf 수에서 **높은 정확도** 달성. BinOCT 대비 **유연한 트리 형태**로 accuracy·sparsity trade-off 개선.[1]
- **속도**: 순수 단일 스레드 구현임에도 BinOCT(8스레드)와 경쟁 가능. 경계 도입 전후 실행 시간·메모리 100× 이상 개선.[1]
- **한계**: 현재 이진 변수·binary split에 한정. multi-class·연속 변수 일반화, **병렬화** 미구현, oblique split(다변수 분할) 미지원.

***

## 5. 일반화 성능 향상 가능성  
- **모델 단순성 제어**: $$\lambda$$를 통해 leaf 수 직접 제약하므로 과적합 방지에 용이하며, **Occam’s Razor bound**로 테스트 오류에 대한 이론적 상한 제공.[1]
- **교차검증**에서도 높은 training accuracy는 대체로 test accuracy 향상으로 이어짐이 확인되어, 최적화된 희소 트리가 **일반화 성능**을 유지·강화함을 시사한다[실험 참조].  

***

## 6. 향후 연구 영향 및 고려 사항  
- **확장성 제고**: 상관 특징(feature) bound 활용 시 상호 대체 가능한 변수 pruning으로 **피처 차원** 확장 가능성 제시.[1]
- **멀티클래스·연속형 변수**: 이진 변수 외 **연속 변수 처리**, 다중 분류로의 이론·실험적 확장이 필요하다.  
- **병렬화·하드웨어 가속**: GPU 병렬 탐색·분산 프레임워크 적용으로 더욱 큰 규모 데이터셋에 대응 가능.  
- **해석 가능도 연구**: oblique split·rule list 통합 등으로 **모델 복잡성**과 **해석 가능성** 간 새로운 균형 모색.  
- **공정성·안정성**: 의료·사법·금융 분야 적용 시 **편향 바이어스** 검증 및 robustness bound 추가 연구가 요구된다.

***

Optimal Sparse Decision Trees는 **해석 가능성**과 **정확도**를 동시에 보장하는 결정트리 최적화의 새 장을 열었으며, 향후 다양한 데이터 타입·실제 고차원 문제로의 확장이 기대된다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/bec03b73-94ff-4844-9ccd-98f3ece15a1f/1904.12847v6.pdf)
