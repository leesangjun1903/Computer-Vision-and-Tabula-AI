# Learning Optimal Decision Trees Using Caching Branch-and-Bound Search

## 핵심 주장 및 주요 기여
“DL8.5” 알고리즘은 **아이템셋(itemset) 기반** 의사결정나무 탐색에 **브랜치 앤 바운드(branch-and-bound)와 캐싱** 기법을 결합하여, 기존 MIP·CP 기반 최적 의사결정나무 알고리즘 대비 **수십 배 이상 빠른** 탐색 성능을 달성한다. 주요 기여는 다음과 같다.[1]
- 아이템셋 경로 표현을 활용한 동적계획(dynamic programming) 기반 트리 구조 탐색
- 브랜치 앤 바운드를 통한 강력한 상·하한(bound) 삭감(pruning)
- 부분 탐색 결과(“NO TREE”)까지 포함한 캐시 저장으로 중복 계산 최소화
- 실행 중 언제든 최적(또는 근접)해를 반환하는 anytime 특성

## 문제 정의
- **목표**: 주어진 이진 분류 데이터에서 최대 깊이(max depth)·최소 지지도(min support) 제약을 만족하면서 분류 오류(error)를 최소화하는 의사결정나무 탐색  
- **수식화**:  
  - 각 아이템셋 $$I$$의 잎 오류(leaf error):  

$$
      \text{error}(I) = |\text{cover}(I)| - \max_{c\in C} \text{support}(I,c)
    $$
  
  - 찾고자 하는 트리 $$DT = \{I_1,\dots,I_k\}$$는

$$\max_{I\in DT} \text{depth}(I) \leq D$$, $$\min_{I\in DT} |\text{cover}(I)| \geq \sigma$$ 를 만족하며  
    
$$\sum_{I\in DT} \text{error}(I)$$를 최소화하는 집합이다.[1]

## 제안 방법
### 1. 아이템셋 기반 탐색
- 각 트리 경로를 아이템셋으로 변환하여 **거래(transaction) 데이터**로 처리
- 아이템셋의 **클래스별 지지도(support)** 로 잎 오류를 정의

### 2. 브랜치 앤 바운드 + 캐싱
- **상한(upper bound)** 파라미터 $$ub$$를 통해 자식 분기로의 탐색 조건을 엄격히 제한
- 이미 $$ub$$ 이하로 탐색이 불가능한 아이템셋은 **“NO TREE”**로 표시하여 재방문 시 즉시 건너뜀
- 탐색 도중 얻은 중간 해를 곧바로 $$ub$$로 갱신해 추가 분기 삭감

### 3. 휴리스틱 분기 순서
- 정보 이득(information gain)에 따른 **오름차순/내림차순** 또는 원본 열 순서
- 깊이 증가 시 **내림차순**이 다소 우수한 성능 확인

### 4. anytime 특성
- **시간 초과 시점**에 탐색 중간까지의 최적해 반환 가능

## 모델 구조
- **재귀 함수** `DL8.5_Recurse(itemset I, ub)` 형태
- 기저 조건: 순수 노드(오류 0) 도달, 최대 깊이 초과, 시간 초과
- 각 속성(attribute)에 대해 양쪽 분기(branch) 오류 합산 후 $$ub$$ 비교
- 캐시 해시맵에 `(I, ub) → (tree, error)` 혹은 `NO TREE` 저장

## 성능 향상
- 24개 이진 데이터셋, 깊이 4 기준:
  - MIP(BinOCT)·CP 기반 대비 **19/24개** 최적해 증명(10분 타임아웃)[1]
  - DL8(기존) 대비 12→19개, CP 기반 대비 11→19개
  - 실행 시간은 **수십 배 단축**(카투스 플롯 참조)[1]

## 한계
- **이진 속성**에 최적화되어 있으며, 연속 속성은 전처리(이진화) 필요
- **지지도 제약(min support)**을 반드시 요구하므로, 소수 표본 분할 시 제약 조정 필요
- 깊이·지지도 외 추가 제약(공정성, 해석 가능성 등) 도입 시 모델 확장 필요

## 일반화 성능 향상 관점
- 상한 기반 분기 삭감으로 **오버피팅 위험**을 통제
- 부분 탐색 결과 캐싱으로 **재탐색 방지**, 데이터 노이즈에 대한 **강건성** 증대
- anytime 특성으로 **학습 시간-성능 트레이드오프** 조정 가능

## 향후 연구 영향 및 고려 사항
- **공정성(fairness), 해석 가능성** 제약 추가를 위한 MIP·CP 기법과의 혼합 연구 가능  
- 대규모 연속형·다중 클래스 데이터셋 처리 위한 **효율적 이진화 기법** 연구 필요  
- 분기 휴리스틱 최적화, **메타러닝** 기반 자동 특성 순서 결정으로 성능 추가 향상 기대  
- 캐시의 메모리·시간 복잡도 분석을 통한 **스케일 아웃(scale-out)** 방안 고려  

***

 5711-Article-Text-8936-1-10-20200513.pdf[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/479ccd39-d35a-400d-91f9-d52c06d31f8a/5711-Article-Text-8936-1-10-20200513.pdf)
