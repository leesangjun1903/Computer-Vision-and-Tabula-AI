# Object Detection and Recognition
## Basics of Object Detection
이미지에서 물체를 감지하는 것은 컴퓨터 비전 애플리케이션의 중요한 기능입니다.  
물체 감지/인식은 장면 라벨링, 로봇 내비게이션, 자율주행차, 얼굴 및 신체 부위 인식, 질병 및 암 감지, 위성 이미지의 물체 인식, 필기 인식 등 다양한 분야에서 사용됩니다.

<img width="696" alt="스크린샷 2025-04-25 오후 3 07 52" src="https://github.com/user-attachments/assets/563b51c4-5a79-41bc-a27e-765396285fca" />

## Object Detection vs. Object Recognition
그림 5-1에서 트럭이나 개가 있는지만 표시하거나 감지했습니다.  
이미지에 있는 물체를 식별하는 것이 목표였기 때문에 자동차의 모델이나 색상, 개의 색상이나 품종과 같은 특정 특성은 인식하지 못했습니다.  
물체 인식은 이미지 내에서 물체를 식별하는 방법입니다. 물체 인식의 경우 먼저 자동차를 감지하고 잘라낸 자동차에서 인식기를 적용하여 자동차의 특징을 인식합니다. 이는 얼굴도 마찬가지입니다.

## Template Matching
객체 감지 및 인식의 일환으로 형상 분석과 특징 분석을 수행해야 합니다.  
이를 수행하기 위해서는 템플릿 매칭이라는 강력한 기법이 있습니다.  
이는 기술적으로 무차별 대입 알고리즘 또는 이전에 획득한 템플릿을 기반으로 객체를 추출하는 간단한 메커니즘입니다.  
OpenCV는 템플릿 매칭을 수행하기 위해 matchTemplate() 함수를 사용합니다.  
이 함수는 쿼리 중인 이미지의 "슬라이딩 창"을 가져와서 검색 중인 이미지를 가로질러 슬라이드하여 존재 여부를 확인합니다.  
이 함수는 한 번에 한 픽셀씩 수행합니다. 그런 다음 이러한 각 위치에 대해 일치하는 항목이 있는지 상관 계수를 계산합니다.  
상관관계가 높은 영역은 일치하는 영역입니다. 그림 5-2는 매칭을 사용하는 일반적인 객체 감지를 보여줍니다.  

<img width="696" alt="스크린샷 2025-04-25 오후 3 10 13" src="https://github.com/user-attachments/assets/6dbda824-9448-4e5b-af7b-386edc5e8f79" />

이 방법은 템플릿을 사용하여 분할 후 객체를 감지합니다. 분할된 객체가 템플릿과 유사하면 객체 감지 프로세스가 종료되고, 그렇지 않으면 유사성 확인을 위해 다른 템플릿을 선택합니다.

## Understanding Image “Features”
템플릿 매칭 접근 방식의 어려움으로 이제 이미지 특징 기반 객체 감지 및 인식에 대해 배우게 됩니다.  
먼저 이미지 처리의 맥락에서 어떤 특징이 있는지 살펴보겠습니다.  
특징은 이미지의 속성 또는 속성에 해당합니다. 특징은 정확한 컴퓨터 비전 애플리케이션을 구축하는 데 중요한 역할을 합니다.  
1장에서 배운 것처럼 픽셀은 두 이미지를 비교하는 데 사용됩니다.  
가장 기본적인 특징 감지 형태는 점 특징입니다. 스마트폰의 파노라마 생성과 같은 애플리케이션에서는 각 이미지가 해당 이전 이미지와 스티칭됩니다.  
이 스티치를 위해서는 픽셀 수준의 정확도와 겹치는 이미지의 올바른 방향이 필요합니다. 두 이미지 간에 해당 픽셀을 계산하려면 픽셀 매칭이 필요합니다.

### Interesting and Uninteresting Points
이미지 내에는 흥미로운 점과 흥미롭지 않은 점이 있을 수 있습니다.  
이미지에서 흥미로운 점은 이미지의 객체에 대해 가장 많은 정보를 제공할 수 있는 점이고, 흥미롭지 않은 점은 이미지 또는 이미지의 객체에 대한 정보를 0 또는 전혀 제공하지 않습니다. 

다음은 흥미롭거나 좋은 기능의 몇 가지 특징입니다:  
- 반복 가능: 이미지 변환에도 불구하고 동일한 기능이 다른 여러 이미지에서도 발견될 수 있습니다.
- 두드러짐/특이함/독특함: 이 기능은 고유하며 사용 사례 맥락에서 독특한 설명을 가지고 있습니다.
- 숫자가 간결함: 맥락에서 객체를 설명하는 픽셀의 수가 측정 가능합니다.
- 로컬: 맥락에서 객체는 이미지 내에서 상대적으로 작은 영역을 차지합니다.

### Types of Image Features
이미지 특징에는 주로 가장자리, 영역, 모서리 특징의 세 가지 유형이 있습니다. 이러한 객체의 특징은 그림 5-4와 같이 강도의 변화를 관찰하여 이미지에서 객체를 추적하는 데 사용됩니다.

<img width="730" alt="스크린샷 2025-04-25 오후 3 32 01" src="https://github.com/user-attachments/assets/d4d27be3-606f-481b-824d-b4875f42f091" />

## Feature Matching
특징 매칭은 다음과 같은 경우 중 하나에 수행할 수 있습니다: 
두 개의 이미지가 있으며, 이러한 이미지가 서로 일치하는지 정량화해야 합니다. 일반적으로 비교 메트릭이 적용됩니다.  
큰 이미지 데이터베이스가 있으며, 모든 새 이미지에 대해 이미지 데이터베이스와 매칭을 수행해야 합니다. 데이터베이스의 모든 이미지에 대해 모든 것을 다시 계산하는 대신 더 작은 검색 기준을 저장한 다음 입력 이미지와 비교합니다. 이를 이미지의 특징 벡터라고 합니다. 모든 새로운 입력 이미지에 대해 유사한 벡터를 추출하여 저장합니다.  
대안적인 접근 방식으로 이미지의 일부가 템플릿으로 저장됩니다. 목표는 이미지에 이 템플릿이 있는지 확인하는 것입니다. 이를 위해서는 템플릿의 키 포인트를 주어진 샘플 이미지와 일치시켜야 합니다. 일치 값이 임계값보다 크면 샘플 이미지에 주어진 템플릿과 유사한 영역이 있다고 말할 수 있습니다. 샘플 이미지에서 템플릿 이미지의 위치를 표시할 가능성이 있습니다.

## Image Corners As Features
이 섹션에서는 모서리를 물체 감지 및 인식 기능으로 사용하는 방법을 배우게 됩니다. 모서리가 반드시 물체의 모든 세부 사항을 제공하는 것은 아니지만 많은 경우에 도움이 됩니다. 

### Harris Corner Algorithm
이 알고리즘은 강도의 변화가 가장 큰 영역을 확인하여 이미지의 내부 모서리를 식별하는 데 도움이 됩니다.  
OpenCV에서는 cv2.cornerHarris() 함수를 사용하여 모서리 감지를 달성합니다.

그러나 모서리를 물체 감지 기능으로 사용할 때는 몇 가지 어려움이 있습니다. 모서리 매칭은 이미지 회전에서는 잘 작동하지만 밝기, 강도 변화, 이미지 스케일링과 같은 변환이나 광도 변화는 작동하지 않습니다.

### Feature Tracking and Matching Flow

<img width="730" alt="스크린샷 2025-04-25 오후 3 45 10" src="https://github.com/user-attachments/assets/6734eed1-6b43-4d6d-ade5-0240a4789a53" />

첫 번째 단계는 표준 특징 추출기를 생성한 다음 주어진 이미지에서 견고한 특징을 추출하는 것입니다.  
이 프로세스는 전체 이미지를 스캔하여 가능한 특징을 찾은 다음 임계값을 설정하는 것을 포함합니다. SIFT, SURF, FAST, BRIEF, ORB 검출기 등과 같은 특징을 선택하는 여러 가지 기술이 있습니다.

추출된 특징은 경우에 따라 모델이 학습할 수 있도록 보다 설명적인 형태로 변환하거나 다시 읽을 수 있도록 저장해야 합니다.  
특징 매칭의 경우 샘플 이미지가 주어졌으며 이것이 참조 이미지와 일치하는지 확인하려고 합니다. 특징 감지 및 추출 후 앞서 보여드린 것처럼 샘플의 특징 간 거리를 계산하기 위해 거리 메트릭이 형성됩니다.  
이 거리가 임계값보다 작다면 두 이미지가 비슷하다고 말할 수 있습니다.

### Scale Variant Feature Transform
스케일 변형 특징 변환(SIFT)은 현재 특허를 받았지만 학문적 목적으로 자유롭게 사용할 수 있습니다.  
이전 섹션에서 특징 추출을 위해 모서리를 사용할 때 발생하는 몇 가지 어려움과 확대할 때 잘 작동하지 않는 방법을 살펴보았습니다. 그림 5-8에서 모서리를 감지하는 데 실패할 수 있는 방법을 확인할 수 있습니다.

<img width="730" alt="스크린샷 2025-04-25 오후 3 58 22" src="https://github.com/user-attachments/assets/bb920b61-7ac7-4944-a9d4-a073af52ee2b" />

### Speeded-Up Robust Features


### Features from Accelerated Segment Test
이전의 특징 검출기는 실시간 이미지를 수집하는 비디오 카메라나 로봇과 같은 실시간 애플리케이션에는 유용하지 않습니다.  
이러한 사용 사례는 런타임에 특징 검출에 지연이 발생하면 실패합니다. FAST 알고리즘은 이미지의 키 포인트를 계산하기 위해 픽셀 이웃을 사용합니다.

### Binary Robust Independent Elementary Features











