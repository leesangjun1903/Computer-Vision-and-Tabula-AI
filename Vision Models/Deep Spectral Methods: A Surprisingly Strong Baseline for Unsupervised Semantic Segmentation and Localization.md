# Deep Spectral Methods: A Surprisingly Strong Baseline for Unsupervised Semantic Segmentation and Localization | Image localization, Semantic segmentation
# 핵심 요약  

**Deep Spectral Methods** 논문은 전통적인 스펙트럴 그래프 이론과 최신 자기지도 학습(Self-Supervised Learning) 기반 비지도 특징을 결합하여, 레이블 없이도 이미지 내 객체의 위치(localization)와 의미론적 분할(segmentation)을 간단한 한 번의 고유벡터(Eigenvector) 분해만으로 수행할 수 있음을 보였다.  
주요 기여:  
- **스펙트럴 분해 기반**: 자기지도 특징으로 구성한 패치 간 유사도 행렬의 라플라시안(Laplacian) 고유벡터가 의미 있는 이미지 영역을 자동으로 분리함.  
- **무학습 기반 객체 위치 탐지**: 두 번째 고유벡터(Fiedler 벡터)의 부호만으로 전경 객체를 이진 분할하고 바운딩 박스로 변환해, 복잡한 기법 없이도 최첨단 성능 달성.  
- **의미론적 분할 파이프라인**: 상위 m개 고유벡터를 이미지별로 군집화해 세그먼트를 추출하고, 세그먼트별 특징을 다시 군집화하여 전체 데이터셋에서 일관된 클래스 라벨을 생성.  
- **이미지 매팅 확장**: 색-특징 융합 스펙트럴 기법을 고해상도에서 적용해 부드러운 전경/배경 분리(Soft Matting)에도 활용.  

---  

## 1. 해결 과제  
- **무감독 객체 위치(Localization) 및 분할(Segmentation)**: Dense한 어노테이션 없이 복잡한 장면에서 여러 객체를 탐지·분할하는 것은 매우 도전적.  
- 기존 비지도 접근법: 클러스터링, GAN 기반 생성·발견, 대조학습(Contrastive Learning) 등이 있으나,  
  - 대부분 **단일 객체**만 처리하거나  
  - 추가적인 약한 지도(saliency, co-occurrence) 의존, 복잡한 훈련 필요.  

## 2. 제안 기법  
### 2.1 특징 융합 및 라플라시안 구성  
원본 이미지 $$I\in\mathbb{R}^{3\times M\times N}$$를 패치 단위로 자기지도 ViT 네트워크 $$\phi$$에 통과시켜  

$$
f = \phi(I)\in\mathbb{R}^{C\times \tfrac{M}{P}\times\tfrac{N}{P}}
$$  

를 추출.  
패치 간 코사인 유사도로 특징 유사도 행렬 생성 후 음수 요소 제거:  

$$
W_{\rm feat} = (f^\top f) \odot \mathbf{1}_{f^\top f > 0}.
$$  

저수준 색 정보는 KNN 매팅 행렬 $$W_{\rm knn}$$으로 구해, 가중합:  

$$
W = W_{\rm feat} + \lambda_{\rm knn}\,W_{\rm knn}.
$$  

여기서 $$\lambda_{\rm knn}$$은 색·특징 융합 정도를 조절하는 하이퍼파라미터.  

### 2.2 스펙트럴 분해  
정규화 라플라시안 정의:  

$$
L = D^{-1/2}(D - W)D^{-1/2},\quad D_{ii} = \sum_j W_{ij}.
$$  

그 고유값-고유벡터 $$\{(\lambda_i,y_i)\}$$를 계산. 상수 고유벡터($$\lambda_0=0$$)를 제외한 후 사용.  

### 2.3 무학습 객체 위치 탐지  
- **Fiedler 벡터** $$y_1$$의 부호로 이진 분할  
- 작은 연결 성분에 바운딩 박스 부여 → 전경 객체 위치  

### 2.4 무학습 단일 객체 분할  
- $$y_1$$을 이진 마스크로 취해 전경 예비 분할  
- CRF 후처리로 해상도 복원  

### 2.5 의미론적(클래스) 분할  
1) 상위 $$m$$개 고유벡터 $$\{y_1,\dots,y_m\}$$를 픽셀-패치별로 K-means($$k=m$$) → 클래스 비지정 세그먼트  
2) 각 세그먼트 영역을 네트워크에 재입력해 **세그먼트 특징** $$\{f_s\}$$ 추출  
3) 전체 데이터셋 $$\{f_s\}$$를 K-means($$K=C$$) → 의미론적 라벨 할당  
4) DeepLab+자기지도 ResNet-50으로 **의사라벨(Self-Training)** 보강  

***

## 3. 모델 구조 및 성능  
- **백본**: DINO 사전학습 ViT-Base/S-16, S-8  
- **객체 위치 탐지(CorLoc)**: VOC07/12, COCO-20k CorLoc 66.4%까지 달성 (기존 최고 LOST 대비 +2.4%p)  
- **단일 객체 분할(mIoU)**: CUB 76.9%, ECSSD 73.3% 등 기존 GAN·대조학습 방법들 제압  
- **의미론적 분할(mIoU)**: VOC12 val set에서 37.2% ±3.8 (자기훈련 전 30.8%) → MaskContrast(35.0%) 상회  
- **이미지 매팅**: 풀 해상도 스펙트럴로 부드러운 RGBA 레이어 분리  

### 한계  
- **소형 객체**: 작은 전경이 첫 고유벡터에 과대 반영되어 주객 분리 실패  
- **프레임·구도**: 이미지 테두리 패턴을 전경으로 오탐  
- **다중 객체 분리**: 의미론적 분할 후 self-training 시 서로 다른 객체 병합 오류 증가  
- **계산 시간**: 중간 해상도 $$H/8$$에서만 실시간급, 풀 해상도 적용 시 라플라시안 고유분해 비용이 상당  

***

## 4. 일반화 성능 관점  
- **스펙트럴 기법**은 네트워크 백본 변경에도 **일관된 영역 분리** 유도  
- **자기지도 ViT**의 ‘키(Key)’ 특징이 공간적 국소성과 의미론적 정보 동시 내장  
- **색 융합 파라미터** $$\lambda_{\rm knn}$$ 조정으로 도메인 특성(자연/의료/위성)에 쉽게 적응 가능  
- **Self-Training** 단계는 소량 가짜라벨만으로도 분할 성능 안정적 향상 → 새로운 도메인 클로즈드 셋에도 전이 잠재  

***

## 5. 향후 영향 및 고려 사항  
- **범용 비지도 분할**: 스펙트럴+자기지도 조합이 레이블 없는 다양한 데이터셋에 강력한 기본틀 제공  
- **작업 확장**: 객체 탐지·세분화 외에도 이미지 매팅, 편집, 도메인 변환에 적용 가능  
- **고려점**:  
  - 풀 해상도 적용 시 효율적 수치 해석(근사 알고리즘) 필요  
  - 작은 객체·다중 인스턴스 분리 제어를 위한 다중 고유벡터 활용법 연구  
  - 도메인별 $$\lambda_{\rm knn}$$ 자동 조정 및 백본 구조 최적화로 일반화 극대화

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/52815a5e-4e7a-4fa1-9f17-6bec8bfd113d/2205.07839v1.pdf
