# LU-NeRF: Scene and Pose Estimation by Synchronizing Local Unposed NeRFs | Pose Estimation, global-optimization

### **핵심 주장 및 주요 기여**

LU-NeRF 논문의 핵심 주장은 **정확한 카메라 포즈 없이도 일반적인 SE(3) 설정에서 신경 방사 필드(Neural Radiance Fields)와 카메라 포즈를 동시에 최적화할 수 있는 로컬-투-글로벌(local-to-global) 접근법**을 제시하는 것입니다[1].

주요 기여는 다음과 같습니다:

**1. 제약 조건이 완화된 포즈 추정**: 기존 방법들이 전방 향 설정, 사전 포즈 분포, 또는 정확한 초기화를 요구했던 것과 달리, 일반적인 6자유도 카메라 설정에서 작동합니다[1].

**2. LU-NeRF 모델**: 소수의 로컬 비포즈 이미지로부터 포즈와 장화된 모델로, 거울 대칭 모호성(mirror symmetry ambiguity) 문제를 해결하는 메커니즘을 포함합니다[1].

**3. 견고한 로컬-투-글로벌 파이프라인**: 로컬 미니-씬 최적화, 포즈 동기화, 전역 정제의 단계적 접근법을 통해 초기 미니-씬에 이상치가 포함되어도 성공적으로 작동합니다[1].

### **해결하고자 하는 문제**

**주요 문제**: NeRF 모델의 실제 환경 배포를 막는 **정확한 카메라 포즈에 대한 의존성**입니다[1]. 기존 Structure-from-Motion(SfM) 파이프라인은 잘 알려진 실패 모드를 가지고 있으며, 작은 포즈 추정 오류도 사실감에 큰 영향을 미칩니다[1].

**기존 방법의 한계**:
- BARF: 실제 포즈에 가까운 초기화(15° 이내) 필요[1]
- GNeRF: 2D 카메라 모델과 사전 포즈 분포 가정[1]  
- NeRF--: 전방 향 설정에만 적용[1]

### **제안하는 방법론**

#### **1. 로컬-투-글로벌 프레임워크**
전체 장면을 겹치는 **미니-씬(mini-scenes)**으로 분할하여 각각 소수의 이미지(3-5개)만 포함시킵니다[1]. 이는 전역 포즈 최적화보다 조건이 더 잘 갖춰진 문제를 만듭니다.

#### **2. LU-NeRF 모델 구조**
**LU-NeRF-1**: 초기 포즈 추정을 위한 경량 NeRF
- 4층 MLP 사용
- 위치 인코딩과 뷰 의존성 제거
- 빠른 수렴을 위한 작은 네트워크[1]

**핵심 손실 함수**:

$$\mathcal{L} = \mathcal{L}\_{photo} + \lambda \cdot \mathcal{L}_{depth\_reg}$$

여기서 깊이 정규화 손실은:

$$\mathcal{L}\_{depth\_reg} = \frac{1}{|R|}\sum_{r\in R}\sum_{i,j=1}^{K}\left[|d_\theta(r_{i,j})-d_\theta(r_{i,j+1})|^2+|d_\theta(r_{i,j})-d_\theta(r_{i+1,j})|^2\right]$$

여기서 $R$은 광선 샘플 집합, $d_\theta(r)$은 광선 $r$에 대한 깊이 렌더링 함수, $K$는 패치 크기입니다[1].

#### **3. 거울 대칭 모호성 해결**
**LU-NeRF-2**: 원본과 반사된 카메라 설정 $\{R_i\}$와 $\{R_\pi R_i\}$로 두 모델을 훈련하여 더 낮은 사진측정 손실을 가진 것을 선택합니다[1].

#### **4. 포즈 동기화**
노이즈가 있는 상대 포즈 관측으로부터 전역 정렬을 찾는 문제:

$$\arg\min_{P \in SE(3)^N} d(P_{ij}, P_j P_i^T)$$

Shonan 회전 방법을 사용하여 카메라 회전을 추정한 후 최소제곱법으로 평행이동을 최적화합니다[1].

### **성능 향상**

#### **정량적 성과**
**카메라 포즈 추정**: GNeRF가 제약 없는 설정에서 큰 성능 저하를 보이는 반면, LU-NeRF는 대부분의 장면에서 우수한 성능을 보입니다[1].

**뷰 합성 품질**: 제약 없는 포즈 분포 하에서 GNeRF와 VMRF를 능가하는 성능을 보입니다[1].

**실제 데이터 적용**: Objectron 데이터셋의 텍스처가 부족한 장면에서 COLMAP보다 우수한 성능을 보입니다[1].

#### **일반화 성능 향상**
**1. 포즈 제약 제거**: 기존 방법들이 2자유도 업라이트 카메라나 특정 고도 범위를 가정했던 것과 달리, 임의의 6자유도 회전에서 작동합니다[1].

**2. 다양한 입력 형태 지원**: 
- 순서가 있는 이미지 컬렉션
- 순서가 없는 이미지 컬렉션
- 최적 그래프 설정[1]

**3. 견고성**: 초기 미니-씬에 이상치가 포함되어도 파이프라인의 각 단계가 견고성을 염두에 두고 설계되어 성공적으로 작동합니다[1].

### **모델의 한계**

#### **1. 계산 비용**
각 미니-씬에 대해 개별적으로 LU-NeRF를 훈련해야 하므로 계산 비용이 높습니다. 단일 LU-NeRF-1 훈련에 평균 1.08시간, LU-NeRF-2에 0.89시간이 소요됩니다[1].

#### **2. 그래프 구축의 어려움**
순서가 없는 장면에서 효과적인 그래프를 구축하는 것이 어려우며, DINO 특징과 RGB 거리 모두 특정 장면에서 실패합니다[1].

#### **3. 특정 장면에서의 실패**
Ship 장면에서는 연결된 그래프의 이상치로 인해 모델이 실패하는 경우가 있습니다[1].

### **향후 연구에 미치는 영향**

#### **1. NeRF 실용화 가속**
정확한 포즈 정보 없이도 NeRF를 활용할 수 있게 함으로써 실제 환경에서의 NeRF 응용을 크게 확대할 것으로 예상됩니다[1].

#### **2. 로컬-투-글로벌 접근법의 확산**
복잡한 전역 최적화 문제를 로컬 하위 문제로 분해하는 접근법이 다른 3D 비전 작업에도 적용될 가능성을 제시합니다[1].

#### **3. SfM 보완 기술**
기존 특징 기반 SfM 파이프라인을 보완하는 기술로, 특히 저텍스처나 저해상도 환경에서 유용합니다[1].

### **향후 연구 시 고려사항**

#### **1. 그래프 구축 개선**
순서가 없는 이미지 컬렉션에서 더 정교한 무감독/자기감독 기법을 통한 근접 그래프 구축 방법 개발이 필요합니다[1].

#### **2. 계산 효율성 향상**
최근 신경 렌더링 발전(InstantNGP, PlenOctrees 등)을 활용하여 계산 비용을 줄이는 연구가 필요합니다[1].

#### **3. 견고성 강화**
더 많은 이상치와 어려운 장면 구성에 대처할 수 있는 견고한 알고리즘 개발이 요구됩니다[1].

#### **4. 실시간 적용**
비디오 시퀀스나 실시간 캡처 환경에서의 적용을 위한 최적화 연구가 필요합니다[1].

이 연구는 NeRF 기술의 실용성을 크게 향상시키는 중요한 기여를 했으며, 향후 3D 비전과 신경 렌더링 분야의 발전에 상당한 영향을 미칠 것으로 예상됩니다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/74cc717b-b76f-41e4-8c1f-328650f0d015/2306.05410v1.pdf
