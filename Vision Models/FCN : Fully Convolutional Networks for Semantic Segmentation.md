# FCN : Fully Convolutional Networks for Semantic Segmentation | Semantic segmentation

## 1. 핵심 주장 및 주요 기여  
**핵심 주장**  
컨벌루션 신경망(CNN)을 픽셀 단위 예측에 그대로 적용하여, 별도의 후처리 없이도 기존 기법을 능가하는 의미론적 분할 성능을 달성할 수 있다는 점을 제시한다.  

**주요 기여**  
- 분류용 CNN(AlexNet, VGG, GoogLeNet)을 완전합성곱망(FCN)으로 변환하여 임의 크기 입력에 대한 밀집 예측 구조 제안  
- 심화 계층의 추상적 특징과 얕은 계층의 위치 정보를 융합하는 **스킵 아키텍처(skip connections)** 도입  
- 네트워크 내부(up­network)에서 학습 가능한 디컨볼루션(upsampling) 레이어 활용  
- PASCAL VOC, NYUDv2, SIFT Flow 등 다양한 데이터셋에서 **20% 상대적 성능 향상** 및 실시간 처리(≈0.17초/이미지)  

***

## 2. 문제 정의 및 제안 방법

### 2.1 해결하고자 하는 문제  
- **픽셀 단위 의미론적 분할**: 각 픽셀에 객체 클래스를 할당하는 밀집 예측(dense prediction) 과제  
- 기존 CNN 기반 분할 기법들은 패치 단위 학습, 초평면(superpixels) 후처리, CRF 등의 복잡한 전·후처리 필요  

### 2.2 제안 모델  
1) **완전합성곱 네트워크(FCN)**  
   - 기존 분류용 CNN의 전결합층을 1×1 합성곱으로 치환  
   - 임의 크기 입력에 대해 h×w×d 형상의 피처 맵을 출력  

2) **디컨볼루션(Deconvolution) 레이어**  
   - 학습 가능한 업샘플링 계층  
   - 결손된 공간 해상도를 복원하여 픽셀 단위 예측 가능  

3) **스킵 아키텍처(skip connections)**  
   - 심층의 **coarse** 예측(stride=32)을 얕은 층(pool4, pool3)에서의 **fine** 예측(stride=16, 8)과 융합  
   - 1×1 합성곱 → 2×, 4× 디컨볼루션 후 덧셈(fusion)  
   - 최종적으로 stride=8 수준의 예측으로 정밀도 향상  

### 2.3 핵심 수식  
- 픽셀별 손실:  

$$
    \mathcal{L} = \sum_{i,j} \ell' \bigl(x_{ij}; \theta \bigr)
  $$

- 합성곱/디컨볼루션 관계:  
  - 디컨볼루션은 역전파 시 합성곱을 뒤집은 형태로 구현  

***

## 3. 모델 구조 및 학습  
- **베이스 아키텍처**: VGG16 기반 FCN-32s → FCN-16s → FCN-8s로 계층 융합  
- **학습 방식**:  
  - 전체 이미지 단위 전경/배경 픽셀을 한 번에 학습(whole-image SGD)  
  - 클래스 불균형 시 손실 가중치화로 보정  
  - 데이터 확장(미러링, 위치 이동) 은 유의미 성능 향상 미검증  

- **성능**:  
  - PASCAL VOC 2012: 기존 51.6 → 62.2 mean IU  
  - NYUDv2, SIFT Flow 등 다양한 벤치마크서도 유의미 개선  

***

## 4. 성능 향상 요인 및 한계  
- **향상 요인**  
  1. 전결합층→합성곱 변환으로 밀집 예측 구조 확보  
  2. 디컨볼루션 학습을 통한 해상도 복원  
  3. 멀티스케일 스킵 연결로 지역 정보와 전역 정보 융합  

- **한계 및 고려점**  
  - 낮은 층(pool3 이하)과의 융합은 계산 비용 대비 성능 기여도 감소  
  - 매우 작은 객체나 경계 세부묘사에는 여전히 한계  
  - 대규모 데이터셋·더 깊은 네트워크에서 일반화 검증 필요  

***

## 5. 일반화 성능 향상 가능성  
- **다양한 모달리티 확장**: RGB-D, 다중 스펙트럼 입력으로 쉽게 확장 가능  
- **전이학습(Transfer Learning)**: 분류용 대규모 데이터로 사전학습 후 세분화 과제에 파인튜닝  
- **클래스 불균형 보정**: 희소계층에 대한 손실 가중치 조정으로 소수 클래스 성능 향상  
- **추가 스킵 및 어텐션**: 더 낮은 층과 어텐션 메커니즘 결합으로 경계 정밀도 향상  

***

## 6. 향후 연구에 미치는 영향 및 고려사항  
- **후속 연구 방향**  
  - 실시간 세그멘테이션·비디오 분할 등 동적 입력 확장  
  - 고해상도 의료 영상, 위성 영상 등 대형 이미지 적용  
  - 그래프 기반·어텐션 융합으로 더 세밀한 경계 표현  

- **연구 시 고려점**  
  1. **계산 효율성**: 높은 해상도 융합 시 메모리·연산 최적화 필수  
  2. **데이터 다양성**: 다양한 환경·도메인에 대한 일반화 검증  
  3. **경계 정밀도**: CRF, 그래프 네트워크 등 후처리 최소화 방안  

FCN은 픽셀 단위 분할 연구의 패러다임을 전환하며, 이후 U-Net, DeepLab, PSPNet 등 다수 후속 연구의 기반이 되었다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/1fe5459f-2d92-48df-b110-0f34bbc1e221/Long_Fully_Convolutional_Networks_2015_CVPR_paper.pdf)
