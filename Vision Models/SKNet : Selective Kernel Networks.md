# SKNet : Selective Kernel Networks | Image classification

## 1. 핵심 주장과 주요 기여  
Selective Kernel Networks는 **신경망 내부의 뉴런이 자극에 따라 가변적 수용영역(RF, Receptive Field)을 가지듯**, 컨볼루션 필터도 입력 특성에 맞춰 동적으로 크기를 선택하도록 설계한 모델이다.  
- **선택적 커널 컨볼루션(SK Convolution)**: 여러 크기의 커널을 분기(Split) → 정보 융합(Fuse) → 소프트맥스 기반 가중치로 선택(Select)  
- **경량화된 구조**: 추가 파라미터·계산량을 최소화하면서도 다양한 규모의 정보를 효율적으로 통합  

## 2. 문제 정의, 제안 방법, 모델 구조, 성능 및 한계

### 2.1 해결하고자 하는 문제  
기존 CNN은 동일한 크기 커널을 고정적으로 사용하거나 다양한 크기 커널을 선형 결합(예: Inception)하지만, **자극에 따라 유연히 수용영역을 조절하는 뇌 시각피질 뉴런 특성**을 반영하지 못함.

### 2.2 제안 방법  
Selective Kernel Convolution은 세 단계로 구성된다.  
1. **Split**  
   - 입력 특성 맵 $$X$$를 서로 다른 크기(예: 3×3, 5×5) 및 그룹·딜레이션 설정의 컨볼루션 $$\mathcal{F}_i(X)=\tilde{U}_i$$로 분기  
2. **Fuse**  
   - 분기 결과를 합쳐 $$U=\sum_i\tilde{U}_i$$  
   - 전역 평균 풀링으로 채널 요약 $$s_c = \frac{1}{H\times W}\sum_{i,j}U_c(i,j)$$  
   - 축소 비율 $$r$$ 적용한 FC층으로 압축 표현 $$z = \delta(\mathrm{BN}(W s))$$  
3. **Select**  
   - 각 분기에 대한 어텐션 가중치  
     
$$
       a_i = \frac{\exp(A_i z)}{\sum_j \exp(A_j z)}
     $$  
   
- 선택적 결합 $$V = \sum_i a_i \cdot \tilde{U}_i$$  

### 2.3 모델 구조  
- **SKNet-50**: ResNeXt-50의 “bottleneck” 블록에서 3×3 컨볼루션을 SK 컨볼루션(SK)으로 대체
- **파라미터·계산량**: ResNeXt-50 대비 파라미터 약 10%↑, FLOPs 약 5%↑  

### 2.4 성능 향상  
- **ImageNet**: SKNet-50 Top-1 오류율 20.79% (ResNeXt-50 22.23%, SENet-50 21.12%)  
- **CIFAR-10/100**: ResNeXt-29 대비 SKNet-29가 파라미터 60%↓에도 유사 성능, SENet 대비 22%↓ 파라미터로 더 우수 성능  
- **경량 모델**: ShuffleNetV2에 SK 적용 시 1.0× 모델 기준 오류율 30.57%→28.36%로 약 2.2%p 개선  

### 2.5 한계  
- **고층(feature abstraction 높은) 레이어**에서 커널 크기 선택 효과 감소  
- **추가 파라미터 및 연산**이 완전히 없는 것은 아니며, 모바일 디바이스 적용 시 고려 필요  

## 3. 모델의 일반화 성능 향상 관점  
Selective Kernel 구조는 다양한 스케일 정보를 **동적으로** 통합하므로,  
- **도메인 변화**에 강인: 입력 물체 크기·배경 변동에도 안정적 성능  
- **소형 데이터셋**에서 과적합 억제: 채널별·상황별 커널 선택이 불필요한 정보 억제  
- **다양한 백본 네트워크**(MobileNet, ShuffleNet 등)에도 쉽게 이식 가능  

이로 인해 적은 파라미터로도 높은 표현력을 확보하여 **일반화 성능**이 크게 향상된다.

## 4. 향후 연구 영향 및 고려 사항  
- **자동 아키텍처 탐색**: 커널 크기·분기 수·저차원 임베딩 차원 등 하이퍼파라미터 자동 최적화 연구  
- **비전 트랜스포머와의 융합**: 스케일 선택 어텐션 메커니즘을 셀프어텐션에 접목  
- **고층 레이어 선택성 개선**: 심화된 동적 조절 기법 도입으로 최근접 정보 바로 결합  
- **경량화 연구**: 모바일·임베디드 환경에서 더욱 경량화된 SK 모듈 설계  

Selective Kernel Networks는 **뇌 기반 동적 수용영역 개념**을 CNN에 성공적으로 도입한 사례로, 향후 다양한 네트워크 설계 및 적응형 모듈 연구에 기반이 될 전망이다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/97f2bfdb-af1b-4ff4-a7fd-ca91158c597e/1903.06586v2.pdf
