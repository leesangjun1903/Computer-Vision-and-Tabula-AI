# LMAR : Empowering Resampling Operation for Ultra-High-Definition Image Enhancement with Model-Aware Guidance | Super resolution

## 핵심 주장과 주요 기여

이 논문은 **Learning Model-Aware Resampling (LMAR)**이라는 새로운 방법을 제안하여 Ultra-High-Definition (UHD) 이미지 향상에서 리샘플링 연산자와 내부 향상 알고리즘 간의 분리 문제를 해결합니다[1]. 

### 주요 기여점

**1. 패러다임 전환**: 기존의 "다운샘플링-향상-업샘플링" 패러다임에서 리샘플러와 향상 모델이 분리되어 있던 문제를 인식하고, 이들을 통합하는 모델 인식 리샘플링을 제안했습니다[1].

**2. 핵심 설계 요소**: 두 가지 핵심 설계인 **보상 커널 추정(Compensatory Kernel Estimation, CKE)**과 **스테가노그래픽 리샘플링(Steganographic Resampling, SR)**을 통해 모델 지식의 안내 하에 맞춤형 리샘플링을 학습합니다[1].

**3. 호환성 유지**: 기존 보간 기반 리샘플링 연산자와하면서도 향상된 성능을 달성합니다[1].

## 해결하고자 하는 문제

### 문제 정의
UHD 이미지는 메가픽셀 수로 인한 계산 부담이 크기 때문에, 기존 연구들은 해상도를 줄여서 처리하는 방식을 채택했습니다. 그러나 이러한 접근법은 **리샘플링 연산자와 내부 향상 알고리즘이 분리되어 있어 모델이 선호하는 정보의 손실**을 초래하고 차선의 결과를 낳습니다[1].

Figure 2에서 보여주듯이, 리샘플링 함수를 조작하면 이미지 품질이 개선되거나 악화될 수 있는 다양한 결과를 보이며, 이는 **모델의 응답이 샘플링 전략에 매우 민감함**을 시사합니다[1].

## 제안하는 방법

### 수학적 공식화

기존 패러다임:

$$x_d = D(x; [h, w]), \quad \tilde{y} = F(x_d), \quad y = U(\tilde{y}; [H, W])$$ [1]

제안된 LMAR 패러다임:

$$\tilde{y} = F(x_d, \Theta(x; D, U, F)), \quad y = U(\tilde{y}; [H, W])$$ [1]

여기서 $$\Theta(x; D, U, F)$$는 모델 인식 리샘플링을 위한 추가적인 보상 정보입니다.

### 1. 보상 커널 추정 (CKE)

**상대 좌표 격자 계산:**

$$C_d(i, j) = (-1 + \frac{2i + 1}{h}, -1 + \frac{2j + 1}{w})$$ [1]
$$C_u(i, j) = (-1 + \frac{2i + 1}{H}, -1 + \frac{2j + 1}{W})$$ [1]

**상대 격자 이동:**

```math
\tilde{C_d} = \text{grid\_sample}(C_d, C_u)
```

[1]

$$\tilde{C_r} = C_u - \tilde{C_d}$$ [1]

$$C_r = (\tilde{C_r}(i) \times h, \tilde{C_r}(j) \times w)$$ [1]

**픽셀 셀:**
$$P_c(i, j) = (\frac{2 \times h}{H}, \frac{2 \times w}{W})$$ [1]

**백프로젝션:**
$$\tilde{x} = \text{Conv}(x - U(x_d; [H, W]))$$ [1]

**보상 커널 예측:**
$$K = \text{MLP}_\phi([C_r; P_c; \tilde{x}])$$ [1]

### 2. 스테가노그래픽 리샘플링 (SR)

**보상 정보 계산:**
$$\Delta x = K \circledast x$$ [1]

**학습 가능한 다운스케일 입력:**
$$x_c = \text{Conv}([x_d; D(\Delta x; [h, w])])$$ [1]

### 최적화 목표

**리샘플링 일관성 손실:**
$$L_{rc} = \text{SmoothL1}(E(x) - U(E(x_c)))$$ [1]

**특징 주의 손실:**
$$L_{fa} = \|\frac{E(x)}{\|E(x)\|_2} - \frac{U(E(x_c))}{\|U(E(x_c))\|_2}\|_2$$ [1]

**적대적 손실:**
$$L_d = \log(D(x_d)) + \log(1 - D(x_c))$$ [1]
$$L_g = \log(D(x_c))$$ [1]

**전체 최적화 목표:**
$$L_c = L_{rc} + \alpha L_{fa} + \beta L_g$$ [1]

## 모델 구조

LMAR은 두 단계 구조로 구성됩니다:

1. **보상 커널 추정 단계**: 상대 좌표 격자, 픽셀 셀, 백프로젝션 정보를 MLP에 입력하여 이미지별 맞춤형 컨볼루션 커널을 생성합니다[1].

2. **스테가노그래픽 리샘플링 단계**: 예측된 커널로 보상 정보를 생성하고, 이를 다운스케일된 입력 이미지에 임베딩하여 새로운 학습 가능한 다운스케일 입력을 만듭니다[1].

## 성능 향상

### 정량적 결과
- **UHD-LOL4K 데이터셋**에서 ×1.8 리샘플링 스케일에 대해 **최대 1.2dB PSNR 향상**을 달성했습니다[1].
- 다양한 리샘플링 스케일(×4, ×3, ×2, ×1.5)에서 일관된 성능 향상을 보여줍니다[1].
- Table 1-3에서 보듯이, CNN-I, CNN-H, Restormer 등 다양한 백본에서 일관된 성능 향상을 달성했습니다[1].

### 정성적 결과
Figure 7과 8에서 보여주듯이, LMAR을 적용한 결과는 **향상된 전역 밝기와 지역 구조적 세부사항**을 보여줍니다[1].

## 모델의 일반화 성능 향상

### 스케일 일반화
LMAR은 **랜덤 스케일 훈련**을 통해 다양한 리샘플링 스케일에 대한 일반화 능력을 확보합니다. 균등 분포 U(1, 4)에서 스케일 팩터를 랜덤 샘플링하여 훈련하므로, 인-디스트리뷰션 및 아웃-오브-디스트리뷰션 스케일 모두에서 효과적입니다[1].

### 리샘플러 일반화
주목할 점은 **하나의 리샘플러 유형에서만 훈련하면 다른 모든 리샘플러에 적용할 수 있다**는 것입니다. 이는 LMAR이 특정 리샘플링 방법에 의존하지 않고 일반적인 모델 인식 원리를 학습함을 의미합니다[1].

### 백본 독립성
CNN 기반 모델(CNN-I, CNN-H)과 Transformer 기반 모델(Restormer) 모두에서 일관된 성능 향상을 보여, **아키텍처에 관계없이 일반화**될 수 있음을 입증했습니다[1].

## 한계점

1. **계산 복잡도**: LMAR은 추가적인 MLP와 컨볼루션 연산을 필요로 하여 약간의 계산 오버헤드가 발생합니다. Table 4에서 보듯이 파라미터 수가 증가합니다[1].

2. **훈련 복잡성**: 적대적 훈련을 포함한 다중 손실 함수의 최적화가 필요하여 훈련 과정이 복잡해집니다[1].

3. **메모리 요구사항**: UHD 이미지 처리를 위해 상당한 메모리가 필요하며, 실험에서 NVIDIA 3090 GPU를 사용했습니다[1].

## 향후 연구에 미치는 영향

### 패러다임 전환의 영향
이 연구는 **리샘플링과 향상 알고리즘을 분리하여 생각하던 기존 관점을 전환**시켰습니다. 향후 UHD 이미지 처리 연구에서 리샘플링 단계를 단순한 전처리가 아닌 모델 성능에 직접적으로 영향을 미치는 중요한 구성요소로 인식하게 될 것입니다[1].

### 모델 인식 전처리의 확장
LMAR의 성공은 다른 전처리 단계(노이즈 감소, 색상 보정 등)에도 **모델 인식 접근법**을 적용할 수 있는 가능성을 시사합니다.

### 효율성과 성능의 균형
UHD 이미지 처리에서 **계산 효율성을 유지하면서도 성능을 향상**시키는 방법론을 제시하여, 실용적인 고해상도 이미지 처리 시스템 개발에 기여할 것입니다.

## 향후 연구 고려사항

1. **경량화 연구**: LMAR의 계산 오버헤드를 줄이면서도 성능을 유지하는 경량화 방법 연구가 필요합니다.

2. **다양한 태스크 확장**: 현재 저조도 향상에 집중된 연구를 디노이징, 디블러링 등 다른 이미지 복원 태스크로 확장하는 연구가 기대됩니다.

3. **실시간 처리**: 실제 응용을 위한 실시간 UHD 이미지 처리를 위한 최적화 연구가 필요합니다.

4. **적응형 스케일링**: 이미지 내용에 따라 적응적으로 리샘플링 스케일을 조정하는 방법론 개발이 유망합니다.

이 연구는 UHD 이미지 처리 분야에서 리샘플링과 향상 알고리즘의 통합적 접근법을 제시하여, 향후 고해상도 이미지 처리 연구의 새로운 방향을 제시했다고 평가됩니다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/53589530-c03e-4964-b512-74a6959b82e4/Yu_Empowering_Resampling_Operation_for_Ultra-High-Definition_Image_Enhancement_with_Model-Aware_Guidance_CVPR_2024_paper-1.pdf
