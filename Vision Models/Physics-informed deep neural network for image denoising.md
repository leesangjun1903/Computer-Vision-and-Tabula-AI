# Physics-informed deep neural network for image denoising | Image denoising

## 핵심 주장 및 주요 기여  
이 논문은 **카메라의 검출 물리법칙**, 즉 포아송 분포(Photon Poisson Distribution, PPD)를 학습 과정에 직접 반영한 새로운 딥 뉴럴 네트워크(DNN) 구조와 손실 함수를 제안한다.  
- **비임의적(normalization-free) 입력/출력 스케일링**: 픽셀 강도를 임의로 정규화하지 않고 카운트율(count-rate)을 포톤 수(photon number)로 변환하는 물리 기반 정규화 적용.  
- **물리정보 기반 손실 함수**: 픽셀별 예측 분포 $$W$$ 와 실제 포아송 분포 평균 $$\mu$$ 간 Kullback–Leibler 발산을 이용한 손실  
- **RESUNET 구조**: U-Net의 스킵 연결과 RCAN(Residual Channel Attention Network)의 잔차 블록을 결합해 노이즈 제거 및 분류 능력을 동시에 확보  

## 1. 문제 정의  
- **현상**: 형광 현미경 등 광학·비광학 이미징에서 픽셀 신호는 카메라의 검출 통계에 따라 포아송 분포를 따르며, 노출 시간 $$\tau $$와 샘플 밀도 $$\rho$$에 비례한 평균 $$\mu=\tau V\rho$$를 갖는다.  
- **기존 한계**: 대부분 DNN 기반 복원 기법은 입력·목표 영상을 픽셀 카운트 범위에 맞춰 임의(percentile)로 정규화하고 MSE/L1 손실을 사용해, 동적 범위(dynamic range)에 따른 성능 편차 및 하이퍼파라미터 튜닝 민감도를 초래.  

## 2. 제안 방법  
### 2.1 물리정보 기반 정규화  
- 카메라 카운트 $$D$$를  
  $$
    D = g\,N_{\text{ph}} + \text{offset}
  $$  
  형태로 역변환해 **포톤 수** $$N_{\text{ph}}$$로 입력·목표 영상을 표현.  

### 2.2 손실 함수  
- 포아송 분포 $$p(n;\mu)$$, $$q(n;W)$$의 Kullback–Leibler 발산을 픽셀 단위로 계산:

$$
    \mathrm{KL}(\mu,W)
    = \sum_n p(n;\mu)\log\frac{p(n;\mu)}{q(n;W)}
    = \mu\log\frac{\mu}{W} + W - \mu.
$$  
- 대칭화하여 최종 손실:

$$
    \mathcal{L}_{\text{KL}}
    = \tfrac12\bigl[\mathrm{KL}(\mu,W)+\mathrm{KL}(W,\mu)\bigr]
    = (\mu - W)\log\frac{\mu}{W}.
$$  

### 2.3 네트워크 구조: RESUNET  
- **인코더–디코더(U-Net)** 아키텍처에  
- **3D 잔차 블록(resnet block)** (3×3×3 Conv + BatchNorm + ReLU + 1×1×1 Conv skip) 삽입  
- 업샘플링에 Transposed Conv, 스킵 연결으로 공간적 정보 보존  
- 출력층 없이 포아송 평균 $$W$$ 직접 예측  

## 3. 성능 평가 및 한계  
| 평가 기준             | LR (10 ms) | NLM   | RCAN  | RESUNET |
|-----------------------|------------|-------|-------|---------|
| MSE 개선             | —          | +15%  | +25%  | **+35%** |
| PSNR 개선 (dB)       | —          | +1.2   | +2.0   | **+2.8**  |
| SSIM                 | —          | 0.68  | 0.75  | **0.82**  |

- **다섯 개 실험 데이터셋(목적 × 형광물질 × NA)**에서 모두 가장 우수한 denoising 성능 확보.  
- **학습 데이터셋과 광학 조건(배율·NA·형광물질)이 다른 테스트셋**에도 artifact 없이 안정적 작동 → **일반화 성능 우수**  
- **한계**:  
  - 포톤 수 예측 범위가 크게 늘어날수록 계산 복잡도 및 메모리 사용량 증가  
  - 물리 파라미터(검출 효율 $$g$$, offset) 사전 교정 필요  

## 4. 모델 일반화 성능 향상 관점  
- **포아송 통계 기반 학습** 덕분에 동적 범위 전 구간에서 균일한 손실 기울기 제공 → 학습 안정성·이식성 강화  
- **스킵 연결 + 잔차 블록 조합**으로 과적합 방지 및 다양한 노이즈 패턴 대응  
- 실제 장비별 캘리브레이션 없이도 **실험 조건 이질성**에 강건  

## 5. 연구적·실무적 시사점  
- **확장성**: X선·전자현미경, 천문학적 저조도 영상 등 모든 Poisson 신호 복원 분야로 적용 가능  
- **향후 과제**:  
  - 포톤 검출 모델 외에 가우시안(readout) 노이즈를 동시 반영한 복합 손실 개발  
  - 온라인(on-the-fly) 교정 없이 작동 가능한 **자체 캘리브레이션 모듈** 통합  
  - 경량화 경량화 모델 설계로 현장·모바일 장치 적용  

이 논문은 **물리법칙을 손실 함수와 구조 설계에 결합**함으로써 딥러닝 기반 이미지 복원의 새로운 패러다임을 제시하며, 다양한 Poisson 통계 기반 영상 처리 분야의 후속 연구에 토대를 제공한다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/ca1a26ac-bd98-438f-8e6b-0b5b5a61eb1b/oe-31-26-43838.pdf
