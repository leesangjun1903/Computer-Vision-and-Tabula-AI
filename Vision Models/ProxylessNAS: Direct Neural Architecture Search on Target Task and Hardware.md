# ProxylessNAS: Direct Neural Architecture Search on Target Task and Hardware | NAS

## 1. 핵심 주장 및 주요 기여  
**핵심 주장**  
ProxylessNAS는 별도의 프록시 작업 없이 대규모 목표 데이터셋(예: ImageNet)과 특정 하드웨어 환경(CPU/GPU/모바일)에서 곧바로 최적의 신경망 구조를 탐색할 수 있음을 보인다.[1]

**주요 기여**  
- Differentiable NAS의 **메모리 문제**를 **경로 이진화(path binarization)**로 해결해, 과파라미터화된 네트워크 학습 시 GPU 메모리 소비를 일반 훈련 수준으로 감소시킴.[1]
- 검색 공간 내 모든 블록을 개별적으로 탐색하고 프록시 없이 직접 최적화하여, 이전 프록시 기반 방법 대비 **직접성(directness)**과 **하드웨어 특화(specialization)**를 달성.[1]
- 네트워크 레이턴시를 모델링하여 **미분 가능한 지연 정규화 손실(latency regularization loss)**로 통합, 또는 REINFORCE 기반 보상 함수로 비미분 가능 목표를 최적화하는 두 가지 알고리즘 제안.[1]

## 2. 문제 정의 및 제안 방법  

### 2.1 해결하려는 문제  
- 전통적 NAS는 수천 개 모델을 메타 컨트롤러로 탐색해야 하며, 대규모 작업(ImageNet)에서 **수만 GPU 시간**을 요구.[1]
- Differentiable NAS(DARTS 등)는 대규모 작업에서 후보 경로 수에 비례해 GPU 메모리가 선형 증가하는 **메모리 폭발** 문제를 겪음.[1]
- 하드웨어 레이턴시는 비미분적 목표로, 기존 NAS는 이를 직접 최적화하지 못함.  

### 2.2 제안된 방법  
1. **경로 레벨 이진화(Path Binarization)**  
   - 각 혼합 연산(mixed operation)의 N개 후보연산 중 **하나만 활성화**되도록 N개의 실수형 파라미터 α를 softmax 확률(p)로 변환한 뒤, 이진 게이트 g로 샘플링.[1]
   - 활성 경로만 메모리에 로드하므로 메모리 사용량을 1/N 수준으로 감소.  

2. **아키텍처 파라미터 학습**  
   - **Proxyless-G (Gradient-based)**: 검증 세트로 α 업데이트. 경로 쌍 비교 방식으로 메모리 비용을 상수로 유지하며 ∂L/∂α 근사 계산.[1]
   - **Proxyless-R (REINFORCE-based)**: 보상 R(모델 성능, 레이턴시)로 이진 게이트 확률을 최적화.[1]

3. **레이턴시 정규화 손실 (Latency Regularization)**  
   - 네트워크 전체 예상 레이턴시:  
     $$E[\mathrm{latency}] = \sum_i \sum_j p_{ij} \, F(o_{ij}) $$  
     여기서 $$p_{ij}=\frac{\exp(\alpha_{ij})}{\sum_k\exp(\alpha_{ik})}$$, $$F(o_{ij})$$는 j번째 연산의 예측 레이턴시.[1]
   - 최종 손실함수:  
     $$\mathcal{L} = \mathcal{L}_{CE} + \lambda_1 \|w\|_2^2 + \lambda_2 E[\mathrm{latency}] $$  

4. **모델 구조**  
   - CIFAR-10: PyramidNet 기반 트리 구조(cell) 사용.[1]
   - ImageNet: MobileNetV2 백본에 MBConv{3,5,7}×{3,6} 및 skip(0) 연산 추가, 폭(depth)과 너비(width)의 직접적 트레이드오프 허용.[1]

### 2.3 성능 향상  
- CIFAR-10: 5.7M 파라미터로 **2.08%** 테스트 오류 달성, AmoebaNet-B 대비 6× 파라미터 절감.[1]
- ImageNet (모바일 ≤80ms 제약): 200 GPU시간으로 **74.6%** Top-1 정확도, MnasNet 대비 0.6%↑, 레이턴시 1.02×↓.[1]
- ImageNet (GPU 최적화): **75.1%** Top-1 정확도, MobileNetV2 대비 3.1%↑, 1.2× 속도 향상.[1]

### 2.4 한계  
- 경로 이진화 확률 샘플링에 따른 최적화 불안정성 가능성.  
- 레이턴시 모델링 오류(RMSE 0.75ms)는 작지만, 복잡한 실제 모바일 환경에 완벽히 대응하진 못함.[1]
- GPU/CPU/모바일 각각 최적화된 모델은 상호 이식 불가(하드웨어별 모델 특화 필요).  

## 3. 모델 일반화 성능 향상 가능성  
- **직접 대규모 훈련**: 프록시 대신 목표 데이터셋에 곧장 NAS 수행으로 아키텍처-데이터셋 부합성 증가.  
- **경로 다양성 보장**: 모든 블록 독립 탐색으로 구조 다양성→과적합 방지 및 일반화 향상.  
- **레이턴시 정규화**: 하드웨어 제약을 훈련 중부터 고려하여, 실제 배포 환경에서 일관된 성능 제공.  

## 4. 향후 연구에 미치는 영향 및 고려 사항  
- **하드웨어 특화 NAS**: 다양한 플랫폼별 모델 설계 시 ProxylessNAS는 표준이 될 수 있으며, FPGA/ASIC 등 특수 하드웨어로 확장 가능.  
- **다목적 최적화**: 정확도·레이턴시 이외에 전력, 메모리 소비도 통합 정규화 손실로 포함하는 연구 요구.  
- **신뢰도 강화**: 경로 이진화 안정화 및 레이턴시 예측 모델의 도메인 일반화를 위한 추가 연구 필요.  
- **자동화 파이프라인**: 대규모 NAS 실행을 위한 **효율적 분산 및 자원 관리** 기법 개발이 후속 과제로 남음.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/61938aa4-6bef-4417-b326-8c8109a93c92/1812.00332v2.pdf
