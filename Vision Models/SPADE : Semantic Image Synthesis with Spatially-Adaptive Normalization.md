# SPADE : Semantic Image Synthesis with Spatially-Adaptive Normalization | Image generation

# 핵심 주장 및 주요 기여 요약

**주장:**  
이 논문은 기존의 픽셀 단위 정규화(normalization) 기법이 의미론적(segmentation) 정보를 희석(wash away)시키는 문제를 지적하고, 입력된 의미론적 레이아웃을 보존·전달하기 위해 공간에 적응적인(Spatially-Adaptive) 정규화 레이어인 **SPADE**(SPatially-ADaptive dEnormalization)를 제안한다.

**주요 기여:**  
1. **SPADE 레이어** 도입  
   – 채널별 활성화에 대해 입력된 세그멘테이션 마스크로부터 공간적으로 가변적인 스케일(γ)과 편향(β)을 학습함으로써 정규화 후에도 의미 정보가 보존됨.  
2. **간소화된 생성기 구조**  
   – 인코더를 제거하고 랜덤 벡터만 입력으로 사용, 다중 해상도 ResNet 블록과 SPADE를 결합한 경량 구조 설계.  
3. **성능 개선**  
   – COCO-Stuff, ADE20K, Cityscapes 등 다양한 데이터셋에서 mIoU, 픽셀 정확도, FID 지표 모두 기존 기법 대비 대폭 향상.  
4. **다중양상 및 스타일 제어**  
   – 랜덤 노이즈 입력 또는 별도의 이미지 인코더를 통해 다양한 스타일 및 다중양상(multimodal) 합성이 가능.  

# 문제 정의 및 제안 방법

## 해결하고자 하는 문제  
- 기존 conditional GAN 기반 이미지 합성(예: pix2pixHD)은 입력 의미론적 마스크를 초기 레이어에만 투입하거나 중간 레이어에서 단순 채널 연결(concatenation)만 수행.  
- InstanceNorm, BatchNorm 등 정규화 레이어가 균일한 레이블 영역을 영(zero)으로 표준화하여, 의미 정보가 “씻겨 나가” 결과물의 레이블 일치도가 낮아짐.

## SPADE 수식  
각 레이어 $$i$$의 활성화 $$h_i$$에 대해 채널 $$c$$, 위치 $$(y,x)$$에서  

$$
\mathrm{SPADE}(h_i)\_{n,c,y,x}
= \gamma_{i,c,y,x}(m)\,\frac{h_{i,n,c,y,x}-\mu_{i,c}}{\sigma_{i,c}} + \beta_{i,c,y,x}(m)
$$

– $$\mu_{i,c},\,\sigma_{i,c}$$는 채널별 배치 통계  
– $$\gamma,\beta$$는 입력 세그멘테이션 마스크 $$m$$을 두 개의 3×3 컨볼루션으로 임베딩한 후 위치별 파라미터로 변환  

## 모델 구조  
1. **입력:** 랜덤 노이즈 $$z$$ (또는 이미지 인코더 출력)  
2. **SPADE ResBlk** 반복 (해상도별로 세그멘테이션 마스크를 다운샘플링해 SPADE에 투입)  
3. **업샘플링:** 각 ResBlk 뒤에 2× 업샘플링  
4. **출력:** 3채널 RGB, Tanh 활성화  
5. **판별기:** PatchGAN 구조에 SpectralNorm, 멀티스케일 판별기 적용  

# 성능 향상 및 한계

## 성능  
- COCO-Stuff mIoU 37.4 → 기존 23.7 (CRN), 14.6 (pix2pixHD) 대비 대폭 향상  
- FID 22.6 → 기존 70.4, 111.5 대비 큰 폭 개선  
- ADE20K, Cityscapes 전반에서도 유사한 성능 우위  

## 한계  
1. **복잡한 레이블 간 경계 처리:** 매우 세밀한 객체 경계에서는 여전히 블러 현상 발생  
2. **학습 비용:** SPADE 레이어 도입으로 연산량 증가 및 메모리 사용량 상승  
3. **고해상도 확장성:** 1024×1024 이상에서 안정적 학습을 위해 추가 최적화 필요  

# 일반화 성능 향상 가능성

- **다양한 조건 추가:** 객체 속성(attribute), 텍스트 설명 등으로 γ/β 모듈을 확장 가능  
- **다중 모달 학습:** 이미지 인코더를 강화해 스타일 외에도 조명·계절·시간대 같은 요인 통제  
- **Self-Supervised 세그멘테이션:** 레이블 없는 데이터에도 SPADE를 활용, 준지도학습(semi-supervised)으로 일반화 확대  
- **경량화 및 효율화:** 저사양 디바이스 적용을 위한 SPADE 양자화, 프루닝 기법 연계  

# 향후 연구에의 영향 및 고려 사항

- **정규화 재고:** SPADE는 conditional normalization의 새로운 패러다임으로, 다양한 생성 모델에 응용 가능  
- **교차모달 합성:** 음성, 텍스트 등 다른 모달리티 조건을 SPADE로 도입해 멀티모달 생성 모델 연구 촉진  
- **안정성 및 편향:** γ/β 학습이 편향된 데이터에 종속될 수 있으므로, 공정성·안정성 검증 필요  
- **빠른 실시간 응용:** 실시간 인터랙티브 합성 시스템에 맞춘 알고리즘 경량화 및 지연(latency) 최소화 연구  

결론적으로 SPADE는 의미론적 레이아웃을 정교하게 반영하는 강력한 정규화 기법을 제시함으로써, 향후 조건부 이미지 합성 및 멀티모달 생성 모델 전반에 혁신적 방향을 제시한다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/7ec53376-ee74-4855-b498-1c4a56272041/1903.07291v2.pdf
