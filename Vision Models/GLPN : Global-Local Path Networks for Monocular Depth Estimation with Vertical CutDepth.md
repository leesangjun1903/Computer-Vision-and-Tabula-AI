# Global-Local Path Networks for Monocular Depth Estimation with Vertical CutDepth

## 핵심 주장 및 주요 기여  
이 논문은 단일 이미지(monocular)로부터 정확한 깊이(depth) 정보를 예측하기 위해 **글로벌 컨텍스트**(장거리 종속성)와 **로컬 연결성**(단거리 구조 정보)을 동시에 효과적으로 통합하는 새로운 네트워크 구조와, 세로 방향 정보를 보존하는 **Vertical CutDepth** 데이터 증강 기법을 제안한다. 주요 기여는 다음과 같다.  
- **글로벌-로컬 경로 아키텍처**: 계층적 트랜스포머 인코더로 글로벌 정보를 캡처하고, 경량 디코더와 선택적 특징 융합 모듈(SFF)을 통해 로컬 세부를 복원하여 양쪽 장점을 결합[1].  
- **수직 특화 데이터 증강**: 기존 CutDepth를 변형해 수직 축 전체를 보존하면서 임의로 수평 크롭을 적용, 깊이 추정에 결정적인 *수직 위치 정보*를 보존하도록 학습[1].  
- **파라미터 효율성**: 약 62M 매개변수로 NYU Depth V2에서 SOTA 성능을 달성하며, 기존 모델 대비 복잡도와 연산량을 크게 줄임[1].  

## 해결하고자 하는 문제  
단일 RGB 이미지로부터 깊이 맵을 예측하는 것은 **본질적 모호성**(ill-posed)과 **지역 구조와 전역 문맥** 간 균형 문제를 동시에 해결해야 한다. 기존 CNN 기반 모델은 로컬 디테일은 잘 잡아내지만 전역 문맥을, 트랜스포머 기반 모델은 전역 정보를 포착하나 세부를 놓치는 한계가 있다.  

## 제안 방법  
1. **인코더(Encoder)**  
   - 입력 이미지를 패치 단위로 임베딩한 뒤, 네 단계 계층적 트랜스포머 블록을 통해 $$1/4,1/8,1/16,1/32$$ 크기 멀티스케일 전역 특징 $$F^E_i$$를 추출[1].  
2. **디코더(Decoder)**  
   - $$1/32$$ 해상도 특징을 $$1\times1$$ 컨볼루션으로 채널 축소 후 연속적 업샘플링 및 2개의 컨볼루션 레이어와 시그모이드로 깊이 맵을 예측.  
   - **Selective Feature Fusion (SFF)** 모듈: 멀티스케일 로컬 특징과 디코더 특징을 채널 차원으로 결합한 뒤, 3×3 Conv–BN–ReLU×2 → 1×1 Conv–Sigmoid를 통해 두 채널 주의(attention) 맵을 생성. 로컬·글로벌 특징에 곱하여 강조하고 합산해 하이브리드 특징을 형성[1].  
3. **Vertical CutDepth**  
   - 랜덤 수평 크롭만 적용해 수직 정보는 원본 그대로 유지. 크롭 영역의 RGB를 대응하는 정답 깊이 맵으로 대체.  
   - 크롭 가로 위치 $$(l,u)=(\alpha W,0)$$, 크기 $$(w,h)=(\max((1-\alpha)W\cdot\beta\cdot p,1),\,H)$$, $$\alpha,\beta\sim U(0,1)$$, $$p\in(0,1]$$

[1].  

수식) **스케일 불변 로그 손실**  

$$
L = \frac1n\sum_i d_i^2 -\frac1{2n^2}\Bigl(\sum_i d_i\Bigr)^2,\quad d_i=\log y_i - \log \hat y_i
$$

[1]

## 모델 구조  
- **인코더**: MiT-b4 기반 계층적 비전 트랜스포머, 각 스테이지에서 패치 병합으로 해상도 감소 및 채널 증가.  
- **디코더**: 업샘플링 모듈 4단계 + 채널 축소, SFF를 통한 스킵 연결으로 다중 스케일 로컬 정보 통합.  
- **파라미터**: 전체 약 62M, 디코더 부분은 0.66M로 매우 경량[1].  

## 성능 개선  
- NYU Depth V2: $$\delta_1=0.915,\;\mathrm{AbsRel}=0.098$$로 Adabins(0.903, 0.103) 및 DPT* 대비 향상[1].  
- SUN RGB-D 크로스 도메인 평가: $$\delta_1=0.814$$로 이전 기법 대비 +4.3%p 향상, 별도 미세조정 없이 뛰어난 일반화[1].  
- 노이즈·블러·조명·기상 등 16종 이미지 왜곡에 대해 모든 유형에서 기존 모델보다 높은 강인성(robustness) 확보[1].  

## 한계 및 고려점  
- **실외 장면**(KITTI)에서는 뛰어난 성능을 보이나 실시간 처리 속도 및 메모리 제약이 남아 있음.  
- Vertical CutDepth는 실내 수직 구조에 특화되어 실외 지형이나 고도 변화가 큰 장면에서는 추가 조정 필요.  
- 트랜스포머 인코더의 계산 비용이 높아 저전력 엣지 디바이스 적용엔 최적화 연구가 요구됨.  

## 일반화 성능 향상 가능성  
- **Vertical CutDepth** 덕분에 수직 기하 정보에 민감치 않은 장면에서도 깊이 예측이 안정적으로 유지되며 크로스 도메인 테스트에서 우수한 결과를 확인[1].  
- 멀티스케일 SFF 모듈은 다양한 크기와 형태의 객체를 효과적으로 융합하므로, 다른 도메인(자율주행, 로봇 비전)에도 전이 학습 시 높은 일반화 잠재력을 가짐.  

## 향후 연구 영향 및 고려 사항  
향후 연구에서는  
- **모델 경량화**: 트랜스포머 기반 인코더를 더욱 압축하여 엣지 환경에서 실시간으로 운용할 수 있도록 최적화 필요.  
- **도메인 적응**: 실외·야간·열적 특성 등 다양한 도메인에서의 Vertical CutDepth 적용 범위 확장 및 자동 튜닝 기법 개발.  
- **안전·신뢰성**: 왜곡 및 공격(Adversarial)에도 강인한 구조적 주의(attention) 메커니즘 연구로 자율주행·드론 비전 등 안전-critical 환경에서 활용성 제고.  

이 논문은 전역·국부 정보를 균형 있게 결합하는 새로운 패러다임과 깊이 추정을 위한 도메인 특화 증강 기법을 제시함으로써, 후속 연구에 **아키텍처 설계**와 **데이터 증강** 측면에서 중요한 기반을 제공한다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/4b759831-0e0a-449b-b062-1be3f3cf6170/2201.07436v3.pdf
