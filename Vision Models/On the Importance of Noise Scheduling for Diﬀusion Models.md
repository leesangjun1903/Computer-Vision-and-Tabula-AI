# On the Importance of Noise Scheduling for Diﬀusion Models | Image generation
# 핵심 요약 및 주요 기여

**핵심 주장**  
이 논문은 **노이즈 스케줄링(noise scheduling)** 전략이 **디퓨전 모델(diffusion models)** 의 성능에 결정적인 영향을 미치며, 특히 입력 이미지 해상도가 커질수록 최적의 노이즈 스케줄이 달라진다는 점을 실험적으로 입증한다.  

**주요 기여**  
1. 다양한 해상도(64×64부터 1024×1024)에서 최적의 노이즈 스케줄이 달라짐을 체계적으로 분석  
2. (1) 노이즈 스케줄 함수(코사인, 시그모이드, 선형) 조정과 (2) 입력 스케일링(input scaling) 두 가지 전략을 비교  
3. 간단한 선형 스케줄 γ(t)=1−t 와 입력 스케일링 b 조합의 **단일 컴파운드 전략** 제안  
4. Recurrent Interface Network(RIN) 구조와 결합해 **고해상도(최대 1024×1024) 단일 스테이지(end-to-end) 이미지 생성**에서 SOTA 달성  

***

# 문제 제기 및 제안 방법

## 1. 문제 정의  
- 디퓨전 모델 훈련 시 t∼U(0,1)로 노이즈 레벨 γ(t)를 결정하는데, 해상도가 커지면 픽셀 간 상관성 증가로 동일 γ(t)에서 노이즈 제거 난이도가 달라진다.  
- 따라서 해상도별로 노이즈 레벨 분포를 재조정하지 않으면 특정 레벨이 과소·과대 학습되어 성능 저하 발생.

## 2. 제안 방법

### 2.1 노이즈 스케줄 함수 조정  
γ(t)를 다음 세 가지 형태로 파라미터화  
- **선형 스케줄**:  

$$
\gamma(t)=\max(1 - t,\,\epsilon)
$$

- **시그모이드 스케줄** (하이퍼파라미터 $$s,e,\tau$$):  

$$
\gamma(t)=\frac{v_e - \sigma\bigl(\tfrac{t(e-s)+s}{\tau}\bigr)}{v_e - v_s},\quad v_s=\sigma\bigl(\tfrac{s}{\tau}\bigr),\;v_e=\sigma\bigl(\tfrac{e}{\tau}\bigr)
$$

- **코사인 스케줄** (하이퍼파라미터 $$s,e,\tau$$):  

$$
\gamma(t)=\frac{v_e - \cos^{2\tau}\bigl((t(e-s)+s)\tfrac{\pi}{2}\bigr)}{v_e - v_s},\quad v_s=\cos^{2\tau}\bigl(s\tfrac{\pi}{2}\bigr),\;v_e=\cos^{2\tau}\!\bigl(e\tfrac{\pi}{2}\bigr)
$$

### 2.2 입력 스케일링  
원본 입력 $$x_0$$에 상수 $$b$$를 곱해 노이즈 세기를 간접 조절  

$$
x_t = \sqrt{\gamma(t)}\,b\,x_0 + \sqrt{1-\gamma(t)}\,\epsilon
$$

- 작은 $$b$$일수록 같은 γ에서 더 강한 노이즈 효과  
- 학습 시 최종 입력을 분산 정규화하여 네트워크가 수용하도록 함  

### 2.3 컴파운드 전략  
- **훈련**: γ(t)=1−t 와 최적 입력 스케일 $$b$$를 결합  
- **샘플링**: 표준 코사인 스케줄로 변조하며, 분산 정규화를 일관 적용  
- RIN 구조에 적용해 단일 스테이지, 업샘플링·캐스케이드·가이드 없이도 고해상도 생성  

***

# 모델 구조 및 성능 향상

| 해상도 | 모델                          | FID    | IS     | 파라미터(M) |
|-------:|-------------------------------|-------:|-------:|------------:|
| 1024×1024 | RIN + 제안 전략 (단일 스테이지) | **8.72** | 163.9  | 412         |
| 1024×1024 | StyleGAN-XL (비교용)         | 7.11   | 189.0  | 775         |
| 512×512   | RIN + 제안 전략               | **3.95** | 216.0  | 320         |
| 512×512   | ADM+Classifier Guidance    | 7.72   | 172.7  | –           |

- **고해상도(512×512~1024×1024)**에서 단일 스테이지 순수 픽셀 기반 모델로 경쟁 기법과 동등 이상의 결과 달성  
- 해상도 증가에 따라 최적 입력 스케일 $$b$$가 감소 (예: 256×256에서 $$b=0.5$$, 1024×1024에서 $$b=0.1$$)  
- 스케줄 함수 조정 대비 단일 스케일 파라미터 튜닝이 더 간편하면서도 효과적

***

# 일반화 성능 향상 관점

- **다양한 해상도**에서 동일한 단일 전략 적용이 가능해 **실험적 일반화(robustness)** 보장  
- 입력 스케일링으로 γ(t)의 모양은 유지하되 전체 logSNR을 이동시키는 방식은 **과적합 방지** 효과  
- RIN의 순환 계산 인터페이스와 결합해 **적응적 컴퓨팅 자원 할당**으로 다양한 데이터셋·도메인에도 확장 가능  
- 향후 **영상 분할, 텍스트-투-이미지** 등 다른 비전 태스크에도 스케줄 최적화를 통한 일반화 개선 기대

***

# 한계 및 향후 고려 사항

- **하이퍼파라미터 탐색 비용**: 입력 스케일 $$b$$는 단일 파라미터지만, 데이터 특성에 따라 최적 값은 달라질 수 있음  
- **샘플링 속도**: 1000단계 DDPM 샘플링 기준, 고해상도 생성 시 연산 부담  
- **클래스 조건 정보 활용 한계**: 단순 클래스 라벨만 사용, 텍스트 설명 등 추가 조건부 정보 결합 시 성능·다양성 향상 가능  

**향후 연구 제안**  
- 스케줄 파라미터와 **컨텐츠 특성(텍스트/레이블)** 를 동적으로 연계하는 **적응 스케줄링**  
- **단계 수 감소**(DDIM, DPM-Solver 등) 기법과 결합한 고속 샘플링  
- 비전 외 **음성·자연어** 등 다른 연속 생성 도메인으로 확장 검증

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/24b7be73-81b4-4cae-9a4a-001c371d1f0d/2301.10972v4.pdf)
