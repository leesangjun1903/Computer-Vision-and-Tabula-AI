# AdaMixer: A Fast-Converging Query-Based Object Detector | Object detection

**주요 주장 및 기여**  
AdaMixer는 쿼리 기반 객체 검출기의 디코더 적응성을 크게 향상시켜 학습 초반 빠른 수렴과 우수한 성능을 동시에 달성한다.  
- 다중 스케일 특징을 3D 공간으로 간주하고, 각 쿼리가 공간(x,y)과 스케일(z) 축에서 샘플링 위치를 학습적으로 조정하도록 설계  
- 샘플링된 특징을 채널 및 공간 차원에서 쿼리별 동적 가중치로 믹싱하여 적응적 콘텐츠 디코딩 실현  
- 백본과 디코더 이외에 추가적인 피라미드나 어텐션 인코더 없이 단순 구조로 뛰어난 검출 성능 확보  

***

## 1. 해결하고자 하는 문제  
기존 쿼리 기반 검출기(DETR, Deformable DETR 등)는  
1) 쿼리가 샘플링할 위치(공간·스케일)는 적응적이나,  
2) 샘플링된 특징을 해석하는 콘텐츠 디코딩은 정적 선형 투영에 머무름  
→ 느린 수렴·복잡한 구조(추가 인코더, FPN 등), 소형 객체 검출력 저하  

***

## 2. 제안 방법  
### 2.1 Adaptive 3D Feature Sampling  
- 백본의 다중 스케일 특징맵을 z축(로그 스케일)까지 포함한 3D 공간으로 정렬  
- 각 쿼리의 위치벡터 (x,y,z,r) 및 콘텐츠벡터 q로부터 Pin개의 오프셋 (Δx_i,Δy_i,Δz_i) 생성  
- 실제 샘플링 좌표:  

$$
    \tilde x_i = x + Δx_i·2^{z-r},\quad
    \tilde y_i = y + Δy_i·2^{z+r},\quad
    \tilde z_i = z + Δz_i
  $$  

- 3D 보간: (x,y) 축에서 양선형, z축에서 가우시안 가중치 합산  

### 2.2 Adaptive Content Decoding (AdaMixer)  
1) **Adaptive Channel Mixing (ACM)**  
   - q로부터 $$M_c∈\mathbb R^{C×C}$$ 생성 → 샘플 행렬 X 채널 변환  
   - $$X' = \mathrm{ReLU}(\mathrm{LN}(X\,M_c))$$  
2) **Adaptive Spatial Mixing (ASM)**  
   - q로부터 $$M_s∈\mathbb R^{P_{\mathrm{in}}\times P_{\mathrm{out}}}$$ 생성 → 공간 구조 변환  
   - $$X'' = \mathrm{ReLU}(\mathrm{LN}(X'^{T}\,M_s))$$  
3) 그룹화(g그룹) 적용으로 다양성 및 효율성 확보  

### 2.3 전체 디코더 구조  
- 각 디코더 스테이지:  
  1) 위치 인식형 멀티헤드 셀프어텐션 (쿼리 간 IoF 편향 포함)  
  2) AdaMixer (ACM→ASM)  
  3) FFN (콘텐츠 q 업데이트)  
  4) 작은 FFN (위치벡터 (x,y,z,r) 업데이트)  

***

## 3. 모델 구조  
- 백본: ResNet/CSP 등  
- 디코더: 6단계, 쿼리 차원 256, 다중 스케일 특징 차원 256  
- 그룹 수 g=4, Pin=32, Pout=128  
- 손실: Focal + L1 + GIoU, 옵티마이저 AdamW  

***

## 4. 성능 향상 및 한계  
- **빠른 수렴**: 12 에폭(1× 스케줄)만으로 45.0 AP (ResNet-50, N=500) 달성  
- **소형 객체 검출**: 작은 객체 APs 최대 27.9점  
- **3× 훈련**: 36 에폭에 47.0 AP → Swin-S 기반 51.3 AP (테스트-dev)  
- **구조 단순성**: FPN·추가 인코더 불필요 → 연산량·파라미터 절감  
- **한계**: 동적 믹싱 가중치 생성을 위한 선형층 파라미터 수 여전히 큼  

***

## 5. 모델의 일반화 성능 향상 관점  
- 3D 샘플링이 다양한 스케일·위치 변형에 적응하여 다양한 객체 분포 학습  
- 채널·공간 별 동적 믹싱으로 쿼리와 특징 간 강건한 상관관계 학습  
- 쿼리 간 위치 기반 IoF 편향은 중복 억제 및 정확한 박스 조정에 기여  

***

## 6. 향후 연구에 미치는 영향 및 고려사항  
- **영향**: 디코더 적응성의 중요성 재조명하여 경량적이면서도 성능 뛰어난 구조 설계 촉진  
- **고려사항**:  
  - 동적 파라미터 규모 축소 방안(저랭크 분해, 가중치 공유 등)  
  - 3D 샘플링 방식의 효율화(CUDA 최적화, 양자화)  
  - 더 다양한 백본·데이터셋으로의 일반화 실험  
  - 비지도·반지도 학습과 결합한 적응 디코더 연구  

> AdaMixer는 쿼리 기반 검출기의 **디코더 적응성**을 극대화함으로써 단순 구조로도 빠른 수렴과 높은 성능을 달성한 중요한 기여를 보여준다. 앞으로 경량·고성능 검출기 설계의 기준점이 될 것이다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/4e8b4735-01d0-4b0f-923b-31955216ad97/2203.16507v2.pdf
