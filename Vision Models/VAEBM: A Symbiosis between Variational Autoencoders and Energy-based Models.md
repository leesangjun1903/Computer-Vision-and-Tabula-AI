# VAEBM: A Symbiosis between Variational Autoencoders and Energy-based Models | 2020 · 147회 인용, Image generation

# 핵심 요약  
**VAEBM**은 **Variational Autoencoder(VAE)**의 효율적인 잠재변수 학습과 **Energy-Based Model(EBM)**의 유연한 데이터 분포 학습을 결합해, 두 모델의 단점을 상호보완적으로 극복하고자 한다. 주요 기여는 다음과 같다:  
- VAE의 근사 후방분포와 EBM의 에너지 함수를 결합한 새로운 **공동 학습 프레임워크** 제안.  
- MCMC 기반 샘플링을 VAE의 효율적 인코더–디코더 경로에 통합해, **고품질 샘플링**과 **안정적 학습** 달성.  
- 다양한 데이터셋에서 VAE 단독 대비 **샘플 품질(FID)** 및 **로그 가능도** 개선을 입증.  

# 문제 정의  
기존 VAE는 잠재공간 학습이 효율적이나, 생성 샘플이 흐릿해지는 경향이 있고, EBM은 데이터 분포를 세밀히 모델링하지만 샘플링이 느리고 불안정하다.  
VAEBM은  
1. VAE의 **인코더–디코더** 아키텍처를 통해 잠재공간 요약을 빠르게 학습하고,  
2. EBM의 **에너지 함수**를 통해 데이터 분포의 미세 구조를 보정함으로써,  
정확성과 효율성을 동시에 만족하는 모델을 제안한다.  

# 제안 방법  
모델은 **잠재변수 z**와 **관측변수 x**의 공동분포를 다음과 같이 정의한다:  

$$
p_\theta(x,z) \propto \exp\bigl(-E_\theta(x)\bigr)\,p_\phi(x\mid z)\,p(z)
$$  

여기서  
- $$p_\phi(x\mid z)$$는 VAE 디코더,  
- $$E_\theta(x)$$는 EBM 에너지 함수,  
- $$p(z)$$는 사전분포이다.  

최적화는 변분 하한을 최대화하면서, EBM의 파라미터는 샘플된 x에 대해 MCMC(예: Langevin Dynamics)를 수행해 추정한다. VAE의 인코더 $$q_\psi(z\mid x)$$는 학습 안정성을 위해 사용되며, 최종 학습목표는  

$$
\mathcal{L} = \mathbb{E}_{q_\psi(z\mid x)}\bigl[\log p_\phi(x\mid z)\bigr] - \mathrm{KL}\bigl(q_\psi(z\mid x)\|p(z)\bigr) - E_\theta(x)
$$  

로 요약된다.  

# 모델 구조  
VAEBM은 크게 세 모듈로 구성된다:  
- **인코더** $$q_\psi(z\mid x)$$: 입력 x를 잠재 z로 맵핑  
- **디코더** $$p_\phi(x\mid z)$$: z로부터 재구성된 x 생성  
- **에너지 네트워크** $$E_\theta(x)$$: 데이터 분포 보정용 점수 함수  

학습 시, 디코더 출력과 관측값 사이 재구성 손실이 VAE 파라미터를 업데이트하고, 에너지 네트워크는 재샘플링된 x에 대한 MCMC 반복을 통해 에너지를 조정한다.  

# 성능 향상 및 한계  
다양한 벤치마크(예: CIFAR-10, CelebA)에서 VAEBM은 VAE 대비 FID 점수를 15–30% 개선하며, 로그 가능도도 유의미하게 증가시켰다.  
그러나 다음과 같은 한계가 존재한다:  
- **샘플링 비용 증가**: MCMC 반복으로 인해 생성 속도가 느림.  
- **모드 붕괴 위험**: EBM의 강한 에너지 조정이 특정 영역에 편중될 가능성.  
- **하이퍼파라미터 민감도**: MCMC 스텝 수, 에너지 함수 구조 등에 민감해 조정이 까다로움.  

# 일반화 성능 개선  
EBM의 에너지 함수는 데이터 분포의 미세 구조를 학습해, **OOD(Out-of-Distribution) 데이터**에 대한 분포 차이를 명확히 인식하고 재구성 성능을 유지하도록 돕는다. 특히 학습된 에너지가 **분포 외 샘플**에 대해 높은 에너지를 부여함으로써, 모델이 불명확한 입력을 과도하게 재구성하지 않도록 한다. 이로 인해 VAEBM은 **OOD 검출** 및 **일반화** 측면에서 기존 VAE보다 우수한 성능을 보였다.  

# 향후 연구 영향 및 고려사항  
VAEBM은 VAE와 EBM의 시너지를 입증함으로써, 두 범주의 모델을 결합한 **하이브리드 접근** 연구에 새로운 길을 열었다. 향후 연구에서는  
- **효율적 샘플링**: MCMC 대체 기법(예: 학습 기반 샘플러) 연구  
- **경량화 에너지 네트워크**: 경량·고속 평가 가능한 에너지 함수 구조 개발  
- **다양한 도메인 적용**: 자연어·시계열 등 멀티모달 분포 모델링 확장  
- **자동 하이퍼파라미터 튜닝**: 샘플링 단계 및 에너지 구성 최적화 자동화  
등을 고려할 필요가 있다.
