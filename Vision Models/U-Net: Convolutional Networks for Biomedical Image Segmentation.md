# U-Net: Convolutional Networks for Biomedical Image Segmentation | Semantic segmentation

## 1. 핵심 주장 및 주요 기여  
U-Net은 매우 적은 수의 주석 이미지만으로도 정밀한 픽셀 단위 분할을 가능하게 하는 완전 합성곱 네트워크 구조를 제안한다.  
- **대칭적인 U자 형태의 네트워크**: 컨텍스트를 포착하는 수축(contracting) 경로와 상세 정보 복원을 위한 확장(expansive) 경로를 대칭적으로 결합.  
- **데이터 증강 전략**: 탄성 변형(elastic deformation)을 포함한 과도한 데이터 증강을 통해 소량 데이터로도 강력한 성능 달성.  
- **효율적인 타일링**: 입력을 타일별로 처리하되 경계에서는 미러링(mirroring)으로 부족한 문맥을 보완하여 임의 크기 영상에도 무손실 분할 가능.

## 2. 문제 정의  
바이오메디컬 영상 분할에서는  
- 수천 장의 주석 이미지 확보가 어려우며,  
- 픽셀별 정확한 레이블링이 필요하지만 전통적 분류 네트워크는 전체 영상을 하나의 클래스만 예측.  
U-Net은 “한 픽셀마다 클래스 예측”과 “컨텍스트와 로컬 정보를 모두 활용”을 동시에 해결하고자 한다.

## 3. 제안 방법  
### 3.1 모델 구조  
U-Net은 총 23개의 합성곱 층으로 구성되며, 네트워크는 크게 두 부분으로 나뉜다.  
  - **수축 경로(Contracting Path)**  
    -  반복되는 3×3 unpadded convolution + ReLU ×2  
    -  2×2 max-pooling (stride 2) → 특징 채널 수 2배 증가  
  - **확장 경로(Expansive Path)**  
    -  2×2 up-convolution (채널 수 절반)  
    -  수축 경로의 대응 레벨 특징 맵과 crop-then-concatenate  
    -  3×3 convolution + ReLU ×2  
  - **최종 예측**: 1×1 convolution으로 클래스별 채널로 매핑  

### 3.2 손실 함수  
픽셀별 softmax와 교차엔트로피에 **가중치 지도** $$w(x)$$를 도입하여 접촉하는 셀 경계에 높은 페널티 부여:  

$$
E = -\sum_{x \in \Omega} w(x)\,\log p_{\ell(x)}(x)
$$  

$$
w(x) = w_c(x) + w_0 \exp\Bigl(-\tfrac{(d_1(x)+d_2(x))^2}{2\sigma^2}\Bigr)
$$  

- $$w_c(x)$$: 클래스 빈도 보정  
- $$d_1,d_2$$: 최근접·차차접 셀 경계까지 거리  
- 실험값: $$w_0=10,\ \sigma=5$$

### 3.3 데이터 증강  
- **탄성 변형**: 3×3 격자상의 무작위 변위(표준편차 10px) → bicubic 보간  
- **회전·이동·회색조 변환**  
- **Drop-out** 통한 추가적인 변형 학습

## 4. 성능 향상 및 한계  
- **EM 신경세포 분할(ISBI 2012)**: 기존 슬라이딩 윈도우 방식 대비 warping error 0.000353, rand error 0.0382로 최고 성능.  
- **세포 분할 경쟁(ISBI 2015)**: PhC-U373 IOU 92%, DIC-HeLa IOU 77.6%로 2위 대비 크게 개선.  
- **제한점**:  
  - 대규모 컬러·3D 볼륨 분할에서는 GPU 메모리 제약  
  - 완전히 새로운 변형 유형에 대해서는 증강 전략 추가 필요  
  - 실시간 처리에는 네트워크 크기와 연산량이 부담

## 5. 일반화 성능 향상 관점  
- **강력한 증강**: 탄성 변형 등으로 학습된 불변성은 새로운 데이터셋에서도 전이 가능  
- **대칭 구조**: 로컬·글로벌 정보를 다각도로 통합하여 과적합 억제  
- **가중치 초기화**: He 초기화($$\mathcal{N}(0,\,2/N)$$)로 각 특징 맵 분산 균일  
- 추후 연구에서 **도메인 적응(domain adaptation)** 또는 **대조 학습(self-supervised learning)** 기법과 결합 시 제한된 주석 데이터에서도 더욱 강인한 일반화 기대

## 6. 향후 연구 영향 및 고려 사항  
- **모델 경량화**: 모바일·임베디드 환경 적용을 위한 네트워크 압축·양자화  
- **3D·다중 모달 확장**: 3차원 U-Net, 멀티채널 입력(다중 형광·CT·MRI)  
- **자동 증강 기법 자동화**: AutoAugment, RandAugment와의 통합  
- **불확실성 추정**: Bayesian U-Net으로 예측 신뢰도 제공  
- **해석 가능성**: Grad-CAM 등 시각화로 의료 진단 보조 및 규제 대응  

U-Net은 소수의 라벨링으로도 정교한 분할을 가능하게 하여, 바이오의료 영상뿐 아니라 일반 영상 분할 분야에서도 표준 아키텍처로 자리잡았다. 앞으로 경량화·3D 확장·도메인 적응 기술과의 결합이 활발히 이루어질 것이다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/16418b81-183e-4d54-827c-1e9b342dc119/1505.04597v1.pdf
