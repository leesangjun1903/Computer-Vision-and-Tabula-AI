# Background Subtraction: Experiments and Improvements for ViBe | Semantic segmentation

# 핵심 요약 및 기여

**주요 주장**  
Background Subtraction 기법인 ViBe의 원본 알고리즘은 픽셀별로 20개의 샘플을 무작위로 저장·갱신하며, 주변 이웃으로 배경 값을 전파(propagation)하여 전경과 배경을 구분한다. 그러나 이 방식은 내부 경계(border)에서의 과도한 전파, 다중 모달 배경(multimodal background) 처리 부재, 카메라 흔들림 및 깜빡임(blinking) 픽셀 미처리 등 여러 문제를 안고 있다.[1]

**주요 기여**  
1. **업데이트 마스크와 세그멘테이션 마스크 분리**  
   - 전경 검출용(segmentation)과 모델 갱신용(updating)을 서로 다른 마스크로 처리하여, 전경 픽셀이 배경 모델에 잘못 포함되는 것을 방지.  
2. **연결 성분 필터링**  
   - 세그멘테이션 마스크: 작은 전경 블롭 제거(면적 ≤10), 작은 구멍 채움(면적 ≤20).  
   - 업데이트 마스크: 전경 내부의 작은 구멍(≤50)만 채워 노이즈성 배경 시드(seed) 삽입 최소화.  
3. **전파 억제(Inhibition of Propagation)**  
   - 배경 블롭 내부 경계의 그라디언트가 임계값(50) 이상이면 전파를 억제하여, 정적 객체(static object)에 대한 과도한 배경 전파 방지.  
4. **적응 거리 측정과 임계치**  
   - 컬러 왜곡(color distortion) 측정: Kim et al.의 colordist() 사용, 임계치 20 적용.  
   - 밝기 차이 임계치: 모델 샘플 표준편차 σₘ의 0.5σₘ을  범위로 한정하여 동적 배경 처리 개선.
5. **깜빡임 픽셀 감지(Blinking Pixels)**  
   - 픽셀 업데이트 마스크의 이전 상태와 비교하여 빈도가 높은 변동을 추적, 레벨이 30 이상이면 갱신에서 제외. Σ–Δ 기법 유사 적용.  
6. **카메라 흔들림 대응**  
   - Kanade–Lucas–Tomasi 트래커로 100개 특징점 추적, 프레임별 움직임 비율로 전체 시퀀스의 흔들림 감지 시 업데이트 팩터를 1로 조정.  

# 문제 정의 및 제안 기법

## 해결하고자 하는 문제  
- **정적 객체 유지**: 원본 ViBe는 전파로 인해 고스트(ghost) 잔상이 서서히 사라지지만, 정적 객체도 의도치 않게 배경으로 합류.  
- **다중 모달 배경**: 표본 기반 모델(sample-based model)에는 명시적 분포 적응 메커니즘이 없어, 밝기·색상 변화가 잦은 배경 처리에 취약.  
- **카메라 움직임 및 깜빡임**: 고정 카메라 가정에서 벗어나면 모델 갱신 신뢰도 저하.  

## 제안 기법 상세  

1. **모델 구조**  
   - 픽셀당 20개 샘플 저장  
   - 무작위 선택 기반 갱신(random policy)  
   - 8-이웃(spatial) 전파 메커니즘  

2. **수식 및 임계치**  
   - **컬러 왜곡**: colordist($$C$$, $$C_m$$) < 20[1]
   - **밝기 임계치**:  

$$
       T = \max\bigl(20,\min(0.5\sigma_m,40)\bigr)
     $$
     
  여기서 $$\sigma_m$$은 픽셀 모델 샘플의 표준편차.[1]
   
   - **전파 억제 조건**:  

$$
       \text{if } \nabla I_{\text{border}} > 50 \text{ then inhibit propagation}
     $$
   
   - **깜빡임 레벨 갱신**:  

$$
       L_{t+1} = \begin{cases}
       \min(L_t + 15, 150), & \text{경계에서 업데이트 상태 변동 시}\\
       \max(L_t - 1, 0), & \text{그 외}
       \end{cases}
     $$
     
  픽셀이 깜빡임으로 분류될 조건: $$L \ge 30$$.  

3. **처리 흐름**  
   1) 초기 100프레임: 업데이트 팩터 = 1  
   2) 나머지 프레임: 업데이트 팩터 = 5 (흔들림 시 1)  
   3) 매 프레임마다 전경/배경 분리 → 필터링 → 전파 억제 → 모델 갱신  

# 성능 향상 및 한계

- **PBC(Poor Classification)**: 전 범주에서 평균 2.18%로, 원본 ViBe(3.20%) 대비 개선.[1]
- **Precision**: 전 범주에서 0.8318로, 원본(0.7301) 대비 유의미한 향상.[1]
- **한계**  
  - *Baseline* 카테고리에서는 경미한 성능 저하 관측(단순 장면에 불필요한 연산 과다).[1]
  - 대규모 다중 모달 분포 적응은 여전히 표본 기반 방식 한계로 남음.  
  - 실제 산업용 고해상도·고프레임카메라 영상 처리 시 계산 비용 증가 우려.  

# 일반화 성능 향상 가능성

- **적응적 임계치**와 **컬러 왜곡 측정**은 다양한 조명·날씨 조건에서도 일관된 성능 제공 잠재력.  
- **깜빡임 픽셀 감지**는 배경 패턴 변화가 잦은 환경(예: 수면, 나뭇잎 흔들림)에서 과도한 False Positive 저감에 기여.  
- **전파 억제**는 객체 경계 보존을 통해 세그멘테이션 일반화에 유리.  
- *제안된 모듈화된 처리 단계*는 다른 표본 기반 모델이나 가우시안 혼합 모델(GMM)에도 이식 가능성.  

# 향후 연구 영향 및 고려 사항

- **연구 영향**  
  - 표본 기반 모델의 경계 처리 및 깜빡임 현상 처리 기법은 차후 딥러닝 기반 시맨틱 세그멘테이션 전처리로 활용 가능.  
  - 컬러 왜곡 및 적응 임계치 접근법은 비디오 분석 전반에 응용될 여지.  

- **고려할 점**  
  - 실시간 처리 성능: 고해상도 영상에서의 최적화 및 GPU 가속 연구 필요.  
  - 딥러닝과의 결합: 배경 모델 샘플 선택을 강화 학습으로 자동화하여 일반화 성능 극대화.  
  - 고차원 특징(예: 텍스처, 딥 피처) 통합을 통한 다중 모달 배경 적응 강화.  

 첨부 논문 “Background Subtraction: Experiments and Improvements for ViBe” (Van Droogenbroeck & Paquot, 2012)[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/351dcb07-abdd-47ab-b30d-a58fd742e6bd/Background_subtraction_Experiments_and_improvements_for_ViBe.pdf)
