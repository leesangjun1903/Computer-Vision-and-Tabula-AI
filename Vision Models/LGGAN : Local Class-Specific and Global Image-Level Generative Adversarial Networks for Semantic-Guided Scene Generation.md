# LGGAN (Local Class-Specific and Global Image-Level GAN)

## 1. 핵심 주장 및 주요 기여  
**핵심 주장**  
LGGAN은 전통적인 글로벌 이미지 수준 생성(Global)만으로는 작은 객체와 섬세한 지역 텍스처를 충분히 복원하기 어려우므로, 클래스별 지역 생성(Local)을 결합해 전역 구조와 지역 디테일을 동시에 효과적으로 학습할 수 있다고 주장한다[1].

**주요 기여**  
- **클래스별 지역 생성 모듈**을 도입해 각 객체 클래스에 특화된 서브 제너레이터를 학습, 작은 객체와 복잡한 텍스처 세부사항을 개선[1].  
- **전역(Global)–지역(Local) 융합 구조**와 **픽셀 수준 가중치 맵**을 학습해 두 분기(branch)의 출력을 최적 결합[1].  
- **클래스 분류 기반 특징 학습(Class-discriminative feature learning)**으로 서브 제너레이터가 더 구별력 있는 표현을 획득하도록 유도[1].  
- **듀얼 디스크리미네이터**를 통해 의미적(semantic)·이미지 조건을 모두 활용해 판별 성능 강화[1].

## 2. 문제 정의 및 제안 방법

### 2.1 해결하고자 하는 문제  
- 글로벌 생성 네트워크만 사용 시 작은 객체 비율이 낮아 학습이 불균형해지고, 다양한 크기의 객체를 고루 복원하기 어려움[1].  
- 클래스별 데이터 분포 불균형과 네트워크 파라미터 공유로 인해 소형 객체 디테일이 희생됨[1].

### 2.2 제안 방법 개요  
LGGAN은 입력 의미 지도 $$S_g$$를 공유 인코더 $$E$$에 넣어 전역·지역·가중치 분기(branch)로 분기한다.  
1. **전역 생성기 $$G_g$$**: 글로벌 구조 학습  
2. **지역 생성기 $$G_l$$**: 클래스별 마스크 $$M_i$$로 특징 필터링

$$F_i = M_i \odot f'$$  

   여기서 $$f'$$은 인코더 출력 디콘볼루션 후 특징 맵, $$\odot$$는 요소별 곱셈[1].  
4. **가중치 맵 생성기 $$G_w$$**: 픽셀별 가중치 $$W_g, W_l$$ 산출 

$$W_f = \mathrm{Softmax}(G_w(E(S_g)))$$  

   최종 합성:  
   
$$I_c = I_g \odot W_g + I_l \odot W_l$$

[1].  

5. **클래스 분류 손실**: 각 $$F_i$$를 풀링 후 FC로 분류, 가중치 없는 void 클래스 제외[1].  
6. **듀얼 디스크리미네이터 $$D_s, D_i$$**: 의미·이미지 조건을 모두 입력으로 사용[1].

### 2.3 모델 구조  
| 모듈 | 입력 | 출력 | 특징 |
|---|---|---|---|
| Encoder $$E$$ | $$S_g$$ | 특징 맵 | 전역·지역·가중치 분기 공유 |
| Global Gen $$G_g$$ | $$E(S_g)$$ | $$I_g$$ | 전체 레이아웃 복원 |
| Local Gen $$G_l$$ | $$\{M_i \odot f'\}$$ | $$\{I_{l,i}\}$$ | 클래스별 서브 제너레이터 |
| Weight Gen $$G_w$$ | $$E(S_g)$$ | $$W_g, W_l$$ | 픽셀 단위 융합 가중치 |
| Discriminator $$D_s,D_i$$ | (의미+이미지) or (이미지+이미지) | 판별 확률 | 듀얼 도메인 학습 |

## 3. 성능 향상 및 한계

### 3.1 성능 향상  
- **Cityscapes**: mIoU 68.4% (기존 최고 62.3%), Acc 77.1% → 81.4%[1].  
- **Dayton a2g**: Top-1 정확도 48.2% → 48.2% (SelectionGAN 대비 +6%p) 등[1].  
- 지역 디테일(작은 객체)와 전역 구조 복원이 모두 개선되어 Inception Score·SSIM·PSNR 등 전반적 성능 상승[1].

### 3.2 한계  
- **복잡도 증가**: 서브 제너레이터 수에 비례해 파라미터·연산량 증가[1].  
- **데이터 편향**: 매우 드문 클래스나 극단적 장면에서는 여전히 디테일 복원 한계[1].  
- **융합 최적화**: 가중치 맵 학습이 불안정할 경우 전역·지역 간 상충 발생 가능[1].

## 4. 일반화 성능 및 향후 영향

### 4.1 일반화 성능 향상 가능성  
- 클래스별 독립 생성기 덕분에 새로운 클래스 추가 시 모듈화 확장 용이[1].  
- 의미 지도 외에도 키포인트·특징 맵 등 다양한 조건부 입력에 적용 가능[1].  
- 가중치 맵 구조를 도메인 간 융합(예: 다중 모달, 비디오)으로 확장 여지[1].

### 4.2 연구에 미치는 영향 및 고려사항  
- **모듈화 생성기 설계**: 클래스·속성별 분리 학습 패러다임을 다양한 생성 과제에 응용 가능.  
- **융합 전략 연구**: 픽셀 수준 외 계층 혹은 어텐션 기반 융합 추가 연구 필요.  
- **효율성 개선**: 경량화 서브 제너레이터·지식 증류로 연산 최적화 고려.  
- **데이터 불균형 대응**: 적은 샘플 클래스 증강 및 가중치 학습 안정화 기법 개발 권장.

---  
본 논문은 글로벌·로컬 분리·융합이라는 새로운 생성 구조를 제안해 세밀한 디테일까지 복원하면서도 전역 형태를 유지하는 접근을 보여준다. 향후 다양한 조건부 생성 및 도메인 적응 연구에서 핵심 토대가 될 것이다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/b24cf709-3fa9-4ba8-8084-ac729cd4552b/1912.12215v3.pdf
