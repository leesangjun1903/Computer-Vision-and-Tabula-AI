# 출입 통제에 활용 가능한 딥러닝 기반 마스크 착용 판별
# 핵심 요약  

**주장 및 기여**  
본 논문은 공공시설 출입 통제 환경에서 인원이 마스크를 착용했는지 자동으로 판별하는 딥러닝 기반 시스템을 제안한다. 얼굴 전체가 가려진 마스크 착용자와 비착용자를 모두 정확히 감지하기 위해, (1) 양쪽 눈 영역을 기반으로 얼굴을 정렬 및 마스크 착용 영역을 추출하고, (2) 이 영역을 CNN 분류기에 입력하여 98.4%의 높은 정확도로 마스크 착용 여부를 판별한다.  

# 문제 정의  
코로나19 확산 방지를 위해 공공시설 출입 시 마스크 착용이 필수이나, 수작업 검사는 인력과 비용이 과도하게 소모된다. 기존의 얼굴 검출 알고리즘(예: Viola–Jones)은 마스크에 의해 입·코 부위가 가려져 성능이 크게 저하되는 한계를 가진다.  

# 제안 방법  
1. **눈 영역 검출**  
   - OpenCV의 Haar cascade를 사용하여 양쪽 눈 좌표 $$(x_1, y_1)$$, $$(x_2, y_2)$$를 검출.  
   - 두 눈 검출에 실패 시 눈 착용형 모델, 이미지 확대 후 재검출 절차를 순차 적용.  
2. **얼굴 정렬 (Face Alignment)**  
   - 회전 각도  

$$
       \theta = \arctan\!\bigl(\frac{y_2 - y_1}{x_2 - x_1}\bigr)
     $$  
   
   - 입력 이미지를 $$-\theta$$만큼 회전시켜 두 눈이 수평이 되도록 정렬.  
3. **마스크 착용 영역 추출**  
   - 정렬된 얼굴 영역을 고정 크기(140×120 픽셀)로 리사이즈.  
   - 눈 바로 아래 세로 90픽셀, 가로 120픽셀 영역을 마스크 영역으로 잘라냄.  
4. **CNN 기반 분류**  
   - 입력: 마스크 착용 영역의 컬러 이미지  
   - 구조:  
     - Conv1: 5×5 필터 32개 + ReLU → 2×2 MaxPooling  
     - Conv2: 5×5 필터 128개 + ReLU → 2×2 MaxPooling  
     - Fully Connected: 128 노드 → Softmax 출력(착용/미착용)  
   - 학습 설정: MSE 손실, Epoch 30, Batch size 10  

# 성능 및 한계  
- **정확도**  
  - 5-겹 교차검증 결과 평균 98.39% 달성.  
- **속도**  
  - 마스크 영역 추출: 이미지당 평균 0.072초  
  - CNN 판별: 이미지당 평균 0.015초  
- **한계**  
  - 다중 인원이 동시 입장하는 환경에는 부적합.  
  - 눈이 가려지거나 작게 뜬 경우 검출 실패율 존재.  
  - RMFD 및 GTAV 데이터셋에 한정된 실험, 실제 조명·해상도 변화 민감.  

# 일반화 성능 향상 가능성  
- **데이터 다양화**: 다양한 조명, 해상도, 카메라 각도, 인종·연령별 마스크 유형(색상·형태) 데이터를 추가해 학습 시 일반화 성능을 개선할 수 있다.  
- **어그멘테이션**: 기울기 변형, 가우시안 잡음, 밝기·대비 변화를 적용한 데이터 증강으로 검출·분류기의 강건성을 높일 수 있다.  
- **더 깊은 백본 네트워크**: 모바일넷, 레스넷 등 경량화된 고성능 CNN 백본 적용으로 특징 추출력을 강화하고 추론 속도를 유지할 수 있다.  
- **멀티 태스크 학습**: 얼굴 검출, 랜드마크 예측(눈·코·입) 및 마스크 판별을 동시에 수행하도록 모델을 설계하면, 눈 검출 실패 시에도 보완적 예측이 가능하다.  

# 향후 연구 및 고려 사항  
- **대규모 실환경 평가**: 실제 관제 카메라 영상에서 동시 다중 인원, 복잡한 배경·조명 환경을 반영한 필드 테스트 수행이 필요하다.  
- **프라이버시 보호**: 얼굴 식별 및 저장 없이 마스크 착용 여부만 판별하도록 시스템 설계 시 개인정보 침해를 최소화해야 한다.  
- **실시간 처리 및 엣지 배포**: 임베디드 디바이스(CPU/GPU 제한 환경)에서도 실시간으로 동작할 수 있도록 모델 경량화 및 최적화 연구가 요구된다.  
- **다중 객체 대응**: 군중 속 개별 인원을 식별하고 동시에 판별하기 위한 멀티-인스턴스 검출기 통합 연구가 향후 과제로 남는다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/3c24120c-aff8-4ef0-8bd4-4957a0f51f70/Deep-learning-based-face-mask-recognition-for-access-control.pdf
