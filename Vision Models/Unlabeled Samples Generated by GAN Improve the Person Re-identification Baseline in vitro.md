# Unlabeled Samples Generated by GAN Improve the Person Re-identification Baseline in vitro | Image generation

## 1. 핵심 주장 및 주요 기여
**핵심 주장**: GAN으로 생성된 *라벨 없는* 보행자 이미지를 기존 학습 데이터에 *라벨 스무딩 규제*(LSRO)를 적용해 함께 학습시킴으로써, CNN 기반의 person re-identification 성능을 실험적으로 일관되게 향상시킬 수 있다.

**주요 기여**  
- **“in vitro” GAN 활용 파이프라인 제안**: DCGAN으로 학습 세트 자체에서 라벨 없는 샘플을 생성하고, 이를 별도 클래스 없이 기존 CNN 학습에 통합.  
- **라벨 스무딩 규제 for Outliers (LSRO)**: 생성 이미지에는 *균등(label smoothing)* 분포  
  $$q_{\mathrm{LSRO}}(k) = \frac1K \quad (k=1,\dots,K) $$  
  을 할당하여, 실제 이미지에는 일반적인 one-hot 분포, 가상 샘플에는 균등 분포를 사용하는 새로운 손실  
  $$\ell_{\mathrm{LSRO}} = -(1-Z)\log p(y) \;-\; Z\sum_{k=1}^K\frac1K\log p(k), $$  
  (여기서 $$Z=0$$이면 실물, $$Z=1$$이면 GAN 샘플) 를 제안.  
- **일관된 성능 향상 증명**: Market-1501, CUHK03, DukeMTMC-reID 세 대형 re-ID 데이터셋과 CUB-200-2011 fine-grained bird recognition에서 모두 baseline 대비(rank-1 accuracy) 최대 +4.37% 향상 달성.

## 2. 문제 정의, 방법, 모델 구조, 성능 및 한계

### 2.1 해결하고자 하는 문제
- Person re-identification은 각 ID마다 수집 가능한 이미지 수가 매우 제한적(평균 9∼23장)하여 **과적합** 위험이 높음.
- GAN 연구 대부분은 *in vivo* discriminator 내부에 unlabeled 활용 기법에 집중하지만, *in vitro* 방식으로 생성 샘플을 외부 CNN 학습기에 적용하는 연구가 드묾.

### 2.2 제안 방법 및 수식
1. **GAN 학습**  
   - DCGAN 아키텍처 그대로 사용.  
   - 100-dim uniform random vector → 5개 deconv 층 → 128×128×3 생성.  
2. **LSRO 기반 CNN 학습**  
   - CNN: ResNet-50, 마지막 FC 층 노드 수 $$K$$로 유지.  
   
- *실제 이미지*  
     - Label distribution:  

$$
         q(k) = \begin{cases}
           1 & k=y,\\
           0 & k\neq y.
         \end{cases}
       $$
   
- *GAN 이미지*  
     - Label distribution:  

$$
         q_{\mathrm{LSRO}}(k) = \frac1K \quad(k=1,\dots,K).
       $$
   
- 최종 손실:  

$$
       \ell_{\mathrm{LSRO}}
       = -\bigl(1-Z\bigr)\log p(y)\;-\;Z\sum_{k=1}^K\frac1K\,\log p(k),
     $$
     
where $$Z=0$$ for real, $$Z=1$$ for generated.

### 2.3 모델 구조
- **Generator**: 5층 deconv + batch-norm/ReLU, 최종 tanh.  
- **Discriminator**: 5층 conv + FC.  
- **Re-ID CNN**: ImageNet-pretrained ResNet-50, 마지막 FC만 ID 수로 변경, dropout(0.5∼0.75).

### 2.4 성능 향상
- **Market-1501 (single query)**  
  - Baseline: rank-1 = 73.69%, mAP = 51.48%  
  - +24 000 GAN: rank-1 = 78.06% (+4.37%), mAP = 56.23% (+4.75%)
- **CUHK03**: rank-1 +1.6% 향상  
- **DukeMTMC-reID**: rank-1 +2.46% 향상  
- **CUB-200-2011**: top-1 +0.6% 향상 (82.6 → 83.2%)

#### 한계
- 생성 이미지의 *시각적 품질*은 아직 완전하지 않음(잡음·아티팩트 존재).  
- 최적 unlabeled 비율(2× real) 이후 과도하면 **과소적합**(uniform 예측) 발생.  
- GAN 샘플 분포가 원본 데이터셋과 불일치할 경우(예: CUHK03→Market) 향상 폭 감소.

## 3. 모델의 일반화 성능 향상 가능성
- **정규화 효과**: LSRO는 생성 샘플을 통해 네트워크가 특정 시각적 속성(예: 색상, 조명, 포즈)에 과도하게 의존하는 것을 억제.  
- **무작위 변형**: GAN이 원본 분포 근처에서 생성하는 다양한 변형은 unseen 환경(새 카메라·조명)에서도 견고한 피처 학습을 유도.  
- **실제 unlabeled 데이터 활용 확대**: DCGAN이 아닌 *실제* 웹 이미지 등 다른 unlabeled 소스에도 LSRO를 적용하면 더 강한 일반화 효과 기대.

## 4. 향후 연구 방향 및 고려 사항
- **고품질 GAN 모델**(StyleGAN·BigGAN 등) 생성 이미지 사용 시 LSRO 효과 증대 여부 연구.  
- **다양한 unlabeled 소스**(실제 CCTV·스마트폰 영상) 통합과 LSRO 적용.  
- **반복적 pseudo labeling vs. LSRO 하이브리드**: 균등 분포와 점진적 가상 라벨을 결합한 손실 설계.  
- **도메인 적응**: LSRO를 도메인 어댑테이션 프레임워크에 통합해 새로운 카메라 환경 적응력 향상.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/a17013af-6d5b-442e-92f5-2a1870b55009/1701.07717v5.pdf)
