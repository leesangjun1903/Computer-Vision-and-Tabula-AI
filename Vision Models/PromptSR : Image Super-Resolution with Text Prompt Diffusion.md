# PromptSR : Image Super-Resolution with Text Prompt Diffusion | Super resolution

## 1. 핵심 주장 및 주요 기여  
본 논문은 **텍스트 프롬프트**를 **이미지 초해상도**(SR) 작업에 도입하여, 복잡하고 알려지지 않은 열화(degradation) 상황에서 복원 품질을 크게 향상시킬 수 있음을 보인다. 주요 기여는 다음과 같다:  
- 텍스트를 **열화 프라이어(prior)** 로 활용하는 새로운 패러다임 제안  
- 열화 모델과 이진화(binning) 기반의 **텍스트-이미지 생성 파이프라인** 구축  
- 멀티모달 대형언어모델(MLLM)을 통한 **프롬프트 자동 생성** 및 CLIP/T5 기반 인코더 적용  
- 합성·실세계 데이터에서 **최신 기법 대비 우수한 복원 결과** 입증  

## 2. 해결 문제 및 제안 방법  

### 2.1 해결하고자 하는 문제  
- 기존 SR 모델은 보통 단일 모달(LR 이미지)만으로 열화를 추정하고 복원하기 때문에, 복잡·다종(blur, noise, compression 등) 열화 상황에서 일반화 성능이 저하됨.

### 2.2 제안하는 방법  
1) **텍스트-이미지 생성 파이프라인**  
   - HR→LR 생성: blur, resize, noise, compression 네 단계에 걸친 랜덤 열화 적용  
   - 텍스트 프롬프트: 각 열화 단계별 파라미터 분포를 3~5개 구간(bin)으로 나누고, ‘light/medium/heavy’ 등의 정성어로 표현  
   - 예) “[heavy blur, upsample, medium noise, light compression, downsample]”  

2) **PromptSR 모델 구조**  
   - 기본적으로 **T2I 확산모델**(diffusion) 기반 U-Net  
   - 입력: (1) LR 이미지를 bicubic으로 업샘플링한 텐서, (2) 시간 스텝 t 노이즈, (3) 텍스트 임베딩  
   - 텍스트 프롬프트 자동 생성: MLLM(mPLUG-Owl3)을 통해 LR 이미지로부터 열화 텍스트 생성  
   - 텍스트 인코딩: CLIP 또는 T5를 활용한 고성능 임베딩  

3) **수식 개요**  
   - 확산 역과정:  

  $$
       \epsilon_\theta(y_t, x_\text{up}, c) \approx \epsilon
  $$
  
  여기서 $$y_t$$는 시간 t에서의 노이즈 이미지, $$x_\text{up}$$은 업샘플된 LR, $$c$$는 텍스트 프롬프트 임베딩.  
   - 최적화: $$L_1$$ 손실을 통해 노이즈 예측 오차 최소화  

## 3. 성능 평가 및 한계  

### 3.1 성능 향상  
- **합성 데이터**(DIV2K, Urban100 등):  
  - LPIPS 및 DISTS 등 주요 지각(perceptual) 지표에서 기존 기법 대비 평균 10–15% 개선  
- **실세계 데이터**(RealSR, Real45):  
  - CNNIQA, NIMA 등 주관적 품질 지표에서 최고 성능 달성  
- **프롬프트 효과**: MLLM 자동 생성 프롬프트도 파이프라인-derived 프롬프트 대비 성능 격차 2% 이내로 우수  

### 3.2 모델의 일반화 성능  
- 파이프라인 단일 열화 순서 대신 **랜덤 순서**로 학습 시 더 다양한 열화 스펙트럼을 커버  
- **이진화 기반 텍스트 표현**으로 사용자 정의 또는 단축 프롬프트(예: “[medium noise]”만)에도 견고한 복원 성능  

### 3.3 한계  
- 복잡 열화 단계가 많아질수록 **프롬프트 생성 오류** 가능성  
- 매우 세밀한 열화(예: 비정규 분포 noise) 표현 시 **텍스트 이산화** 한계  
- 모델 크기 및 샘플링 스텝(50)으로 인해 **실시간 응답성** 저하  

## 4. 향후 연구 방향 및 고려점  
- **프롬프트 자동화 개선**: 더 정교한 MLLM 튜닝 또는 비지도 프롬프트 학습으로 생성 정확도 향상  
- **이종 모달 통합**: 오디오·메타데이터를 추가하여 다중 프라이어 활용  
- **경량화·가속화**: 실시간 애플리케이션을 위한 확산모델 경량 설계 및 스텝 수 감소  
- **비정형 열화 대응**: 대규모 실제 LR–HR 페어를 기반으로 한 도메인 적응(domain adaptation) 기법 적용  

**요약**: 본 논문은 텍스트 프롬프트를 SR 작업의 열화 프라이어로 활용하여, 복잡·다양한 열화 상황에서 이미지 복원 성능과 일반화 능력을 크게 개선했다. 향후 더욱 정교한 프롬프트 자동화, 경량화 및 다중 모달 프라이어 통합 연구가 기대된다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/8a75ab5d-781f-4f1d-9335-b22ca43cde26/2311.14282v5.pdf
