# Image Filtering

딥러닝에서 이미지의 특징을 뽑아내는 첫걸음은 **엣지(edge)**, 즉 픽셀 강도가 크게 변하는 지점을 찾는 것입니다. 이 글에서는 이미지에서 엣지를 검출하기 위해 사용하는 그래디언트(gradient) 개념부터 대표 필터인 소벨(Sobel), DoG(Derivative of Gaussian), LoG(Laplacian of Gaussian) 필터를 차례로 살펴보겠습니다. 마지막으로 필터를 이미지 경계에 적용할 때 생기는 문제와 해결 방법까지 정리합니다.

***

## 1. 이미지 그래디언트란 무엇인가요?  
이미지를 2차원 함수 $$f(x,y)$$로 보면, 픽셀 값은 함수값입니다. 이 함수의 1차 미분값을 모아 놓은 것이 **그래디언트**입니다.  
- $$\frac{\partial f}{\partial x}$$: 가로 방향 변화량  
- $$\frac{\partial f}{\partial y}$$: 세로 방향 변화량  

연속 함수에서는 미분의 극한(limit)을 쓰지만, 디지털 이미지는 불연속 값입니다. 따라서 **유한 차분(finite difference)** 으로 근사합니다.  
1. 전진 차분(Forward)  
2. 후진 차분(Backward)  
3. 중앙 차분(Central)  

이 차분 연산을 **컨볼루션(convolution)** 으로 구현하면, 이미지에 필터를 적용해 한 번에 미분값을 계산할 수 있습니다.

***

## 2. 소벨(Sobel) 필터로 엣지 검출하기  
엣지는 그래디언트 방향의 **수직 방향**에서 나타납니다.  
- **수평 소벨 필터**: 세로 엣지 검출  
- **수직 소벨 필터**: 가로 엣지 검출  

소벨 필터는 노이즈 억제용 가중치가 포함되어 있어, 단순 차분보다 덜 민감하게 변화량을 포착합니다.  
1. 원하는 방향의 소벨 커널 선택  
2. 이미지에 컨볼루션 수행  
3. $$G_x, G_y$$를 종합해 엣지 방향과 크기 계산  

***

## 3. 노이즈와 블러: DoG 필터  
미분 연산은 **고주파 노이즈**를 증폭시킵니다. 따라서 엣지 검출 전에는 노이즈를 줄여야 합니다.  
- 먼저 **가우시안 블러**로 이미지를 부드럽게 한 뒤 소벨 같은 미분 필터를 적용  
- 이를 하나로 합친 것이 **DoG(Derivative of Gaussian)** 필터로, 연산을 한번에 처리해 효율적입니다.

***

## 4. 2차 미분과 LoG 필터  
1차 미분 대신 **2차 미분(Laplacian)** 을 사용하면, 엣지 근처에서 값이 **제로 교차(zero crossing)** 합니다.  
- **Laplacian of Gaussian(LoG)**: 가우시안 블러 → 라플라시안 연산 순서  
- 엣지 위치에서 0으로 바뀌는 지점을 찾아 검출  
- DoG와 비교 시, 더 정밀하지만 이중 선(double line) 검출이 발생할 수 있습니다.  

두 방법 중 어느 것이 무조건 좋다고 할 수 없으므로, 상황에 맞춰 선택합니다.

***

## 5. 이미지 경계 처리 방법  
필터를 적용할 때, 이미지 가장자리 픽셀도 처리해야 합니다. 대표 방법은 다음과 같습니다.  
- **검은색 테두리(Clip)**: 외곽을 0으로 패딩  
- **래핑(Wrap around)**: 반대쪽 픽셀을 이어 붙임  
- **에지 복사(Copy edge)**: 가장자리 픽셀을 복사해 패딩  
- **반사(Reflect across edge)**: 경계를 기준으로 대칭 복사  
- **가변 필터(Vary filter)**: 경계 근처 필터 크기 조정  

각 방법마다 장단점이 있으므로, 데이터 특성에 따라 선택하세요.

***

이제 이미지 그래디언트와 엣지 검출 필터의 기본 원리와 대표적인 구현 방식을 이해하셨습니다. 딥러닝 전처리 단계에서 엣지 기반 특징을 추출할 때 이 필터들을 적극 활용해 보세요.

[1](https://velog.io/@claude_ssim/%EA%B3%84%EC%82%B0%EC%82%AC%EC%A7%84%ED%95%99-Image-Filtering-Image-Gradients-and-Edge-Detection)

https://velog.io/@claude_ssim/%EA%B3%84%EC%82%B0%EC%82%AC%EC%A7%84%ED%95%99-Image-Filtering-Image-Gradients-and-Edge-Detection
